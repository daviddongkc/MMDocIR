{"layout": 0, "type": "text", "text": "CL ADDER : Assessing Causal Reasoning in Language Models ", "text_level": 1, "page_idx": 0, "bbox": [148, 98, 463, 138], "page_size": [612.0, 792.0]}
{"layout": 1, "type": "text", "text": "Zhijing Jin , Yuen Chen , Felix Leeb , Luigi Gresele ∗ Ojasv Kamal 3 , Zhiheng Lyu 4 , Kevin Blin 2 , Fernando Gonzalez 2 , Max Kleiman-Weiner 5 , Mrinmaya Sachan 2 , Bernhard Schölkopf 1 ", "text_level": 1, "page_idx": 0, "bbox": [118, 177, 495, 221], "page_size": [612.0, 792.0]}
{"layout": 2, "type": "text", "text": "1MPI for Intelligent Systems, Tübingen2ETH Zürich3IIT Kharagpur4 University of Hong Kong 5 University of Washington jinzhi@ethz.ch chen yuen 0103@berkeley.edu fleeb@tue.mpg.de luigi.gresele@tue.mpg.de ", "page_idx": 0, "bbox": [157.38296508789062, 222.68524169921875, 454.61688232421875, 272.75457763671875], "page_size": [612.0, 792.0]}
{"layout": 3, "type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0, "bbox": [283, 280, 329, 292], "page_size": [612.0, 792.0]}
{"layout": 4, "type": "text", "text": "The ability to perform causal reasoning is widely considered a core feature of in- telligence. In this work, we investigate whether large language models (LLMs) can coherently reason about causality. Much of the existing work in natural language processing (NLP) focuses on evaluating  commonsense  causal reasoning in LLMs, thus failing to assess whether a model can perform causal inference in accordance with a set of well-defined  formal rules . To address this, we propose a new NLP task,  causal inference in natural language , inspired by the  “causal inference engine” postulated by Judea Pearl et al. We compose a large dataset, CL ADDER , with 10K samples: based on a collection of causal graphs and queries (association al, interventional, and counter factual), we obtain symbolic questions and ground-truth answers, through an oracle causal inference engine. These are then translated into natural language. We evaluate multiple LLMs on our dataset, and we introduce and evaluate a bespoke chain-of-thought prompting strategy, C AUSAL C O T. We show that our task is highly challenging for LLMs, and we conduct an in-depth analysis to gain deeper insights into the causal reasoning abilities of LLMs. ", "page_idx": 0, "bbox": [143, 299.8245544433594, 470, 464.5564880371094], "page_size": [612.0, 792.0]}
{"layout": 5, "type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0, "bbox": [108, 474, 191, 488], "page_size": [612.0, 792.0]}
{"layout": 6, "type": "text", "text": "Once we really understand the logic behind causal thinking, we could emulate it on modern computers and create an “artificial scientist”. ", "page_idx": 0, "bbox": [143, 494.95654296875, 470, 517.7619018554688], "page_size": [612.0, 792.0]}
{"layout": 7, "type": "text", "text": "—  Pearl and Mackenzie  [ 2018 ] ", "page_idx": 0, "bbox": [341.948974609375, 522.2295532226562, 470, 534.2344970703125], "page_size": [612.0, 792.0]}
{"layout": 8, "type": "text", "text": "Causal reasoning is believed to be one of the hallmarks of human intelligence [ 29 ,  68 ]. The ability to draw causal inferences from available information is crucial for scientific understanding and rational decision-making: for example, knowing whether smoking causes cancer might enable consumers to make a more informed decision [ 17 ,  18 ]; assessing the causal effect of a vaccine is essential for effective policy-making during a pandemic [ 14 ,  44 ,  72 ,  97 ]; and understanding the interplay behind family background, education and income helps devise effective education policies [ 10 ,  11 ,  30 ,  73 ]. ", "page_idx": 0, "bbox": [107, 538.5935668945312, 504, 605.1434936523438], "page_size": [612.0, 792.0]}
{"layout": 9, "type": "text", "text": "Our opening quote therefore mirrors the aspirations of many scientists in artificial intelligence and causal inference: to construct a machine capable of performing sound causal reasoning, and able to answer causal questions at scale and with ease. Recent advances in large language models (LLMs) have brought about a paradigm shift in natural language processing (NLP) and artificial intelligence [ 7 ,  15 ,  39 ,  56 ,  76 ,  103 ,  inter alia ]. These transformative developments raise the question of whether these machines are already capable of causal reasoning:  Do LLMs understand causality? ", "page_idx": 0, "bbox": [107, 609.5025634765625, 504, 676.052490234375], "page_size": [612.0, 792.0]}
{"layout": 10, "type": "image", "page_idx": 1, "img_path": "layout_images/2312.04350v3_0.jpg", "bbox": [109, 72, 503, 304], "page_size": [612.0, 792.0], "ocr_text": "Question: Imagine a self-contained, hypothetical world with only the following conditions, and without any unmentioned factors or\n\ncausal relationships:\n\nPhysical vulnerability has a direct effect on the likelihood of fatality and vaccination decision. Vaccination has a direct effect on\n\nthe fatality rate.\n\nIn the entire population, 50% of the people are vulnerable to a certain disease.\n\nFor vulnerable and vaccinated people, the fatality rate is 4%. For vulnerable and unvaccinated people, the fatality rate is 7%.\nFor strong and vaccinated people, the fatality rate is 1%. For strong and unvaccinated people, the fatality rate is 5.8%.\nOverall, the fatality rate for vaccinated people is 5%, while the fatality rate for unvaccinated people is 4.5%.\n\nDoes getting vaccinated increase the likelihood of death?\n\nGround-Truth Answer: No\n\nCorrect steps to lead to the ground-truth answer:\n\n1) Parse the causal graph: Confounding\nSubskill: Causal Relation Extraction\n\n2) Classify the query type: Average Treatment Effect\nSubskill: Causal Question Classification\n\n3) Formulate the query to its symbolic form:\nE[Y | do(X=1)] - E[Y|do(X = 0)]  Subskill: Formalization\n\n4) Collect the available data:\n\nSubskill: Semantic Parsing\n\nCLadder\n\n5) Derive the estimand using causal inference:\nE[Y | do(X=1)] - E[Y|do(X = 0)] Subskill: Formal Causal Inference\n= \\sum_{Z=v} P(Z=z)\"[P(Y=1|Z=z,X=1) - P(Y=1|Z=z, X=0)]\n\n) - P(V=1|Z=0,X=0)]\n) - P(V=1|Z=1,X=0)]\n\n6) Solve for the estimand by plugging in the relevant data in Step 4:\n= 0.5\"(0.01 - 0.058)+0.5\"(0.04-0.07)\n= -0.039\n\n<0\n\nSubskill: Arithmetics\n", "vlm_text": "The image presents a hypothetical scenario involving vaccination, physical vulnerability, and fatality rates. It poses the question: \"Does getting vaccinated increase the likelihood of death?\" The ground-truth answer is \"No.\"\n\nThe image outlines the steps to reach this conclusion:\n\n1. **Parse the causal graph**: Identify confounding relationships.  \n   - Subskill: Causal Relation Extraction\n\n2. **Classify the query type**: Identify it as an Average Treatment Effect.\n   - Subskill: Causal Question Classification\n\n3. **Formulate the query in symbolic form**: E[Y | do(X=1)] - E[Y|do(X=0)].\n   - Subskill: Formalization\n\n4. **Collect available data**: Provides various probabilities related to vulnerability and vaccination.\n\n5. **Derive the estimand using causal inference**: Calculate using causal relationships.\n   - Subskill: Formal Causal Inference\n\n6. **Solve for the estimand**: Plug in available data and perform calculations.\n   - Subskill: Arithmetics\n\nThe final calculation shows a negative effect size, leading to the conclusion that getting vaccinated does not increase the likelihood of death."}
{"layout": 11, "type": "text", "text": "Figure 1: Example question in our CL ADDER  dataset featuring an instance of  Simpson’s paradox  [ 63 ]. We generate the following (symbolic) triple: (i) the causal query; (ii) the ground-truth answer, derived through a causal inference engine  [ 66 ]; and (iii) a step-by-step explanation. We then  verbalize  these questions by turning them into stories, inspired by examples from the causality literature, which can be expressed in natural language. ", "page_idx": 1, "bbox": [107, 311.3040466308594, 505, 351.9965515136719], "page_size": [612.0, 792.0]}
{"layout": 12, "type": "text", "text": "Many previous works addressed the above question by focusing on  commonsense  causality [ 34 ,  100 , 101 ], inspired by the literature that explores LLMs as  knowledge bases  [ 40 ,  70 ,  83 ] (we refer to this line of work as  causality as knowledge ). This involves assessing the alignment between commonsense knowledge about causal relationships in humans and LLMs. This line of work generally does not focus on evaluating how well models are capable of  causal reasoning . For example, it may be difficult to rule out the possibility that LLMs perform potentially unreliable  amortized causal inference , answering causal questions by a simple repetition of verbal patterns present in the texts composing their training data: 2 ,   in other words, LLMs may just be  “causal parrots”  [ 100 ]. ", "page_idx": 1, "bbox": [107, 371.3515625, 505, 459.7204895019531], "page_size": [612.0, 792.0]}
{"layout": 13, "type": "text", "text": "In this work, we introduce a way to test the  formal causal reasoning in LLMs . To this end, we introduce the CL ADDER  dataset. The specificity of CL ADDER  is that causal questions posed in natural language are  grounded in symbolic questions and ground truth answers : the latter are derived through an oracle  causal inference engine (CI engine)  [ 66 ], which abides by the rules of the causal inference approach described by Pearl  [ 61 ] , based on graphical models and structural causal models (SCMs) [ 23 ,  59 ,  61 ,  69 ,  88 ]. We compose more than 10,000 causal questions that cover a variety of causal queries across the three rungs of the  Ladder of Causation  [ 3 ,  66 ]—i.e.,  association al (Rung 1) , interventional (Rung 2) , and  counter factual (Rung 3) . We consider several causal graphs, giving rise to scenarios which require different causal inference abilities. Additionally, we generate ground-truth explanations with step-by-step reasoning for more in-depth analysis of LLM behavior. Our symbolic questions and answers are then  verbalized , by turning them into stories which can be expressed in natural language. To probe whether LLMs employ amortized causal inference, we construct stories with common sens ical, as well as anti-common sens ical and with nonsensical causal relations: in these latter cases, amortized causal inference is expected to fail, whereas formal causal reasoning would still yield the correct answer. An example question from CL ADDER  is shown in Figure  1 . ", "page_idx": 1, "bbox": [107, 465.1175537109375, 505, 629.8494873046875], "page_size": [612.0, 792.0]}
{"layout": 14, "type": "text", "text": "Exploiting CL ADDER , we also introduce a method to elicit sound causal reasoning in LLMs and help them solve challenging causality questions. Specifically, we develop  C AUSAL C O T , a chain-of-thought prompting strategy [ 96 ] inspired by the CI engine, which prompts the LLM to extract the causal graph, causal query, and available “data” (e.g., conditional or interventional  do - probabilities [ 24 ]) from the question, formalize them precisely, and perform correct causal inferences. ", "page_idx": 1, "bbox": [107, 635.24658203125, 505, 690.8875122070312], "page_size": [612.0, 792.0]}
{"layout": 15, "type": "text", "text": "Our experiments indicate that C AUSAL C O T achieves an accuracy of   $70.40\\%$  , which substantially improves the performance of vanilla GPT-4 by 8.37 points on CL ADDER . ", "page_idx": 2, "bbox": [107, 72.757568359375, 505, 95.67150115966797], "page_size": [612.0, 792.0]}
{"layout": 16, "type": "text", "text": "We summarize the  main contributions  of our work: ", "page_idx": 2, "bbox": [107, 100.029541015625, 311.475341796875, 112.03447723388672], "page_size": [612.0, 792.0]}
{"layout": 17, "type": "text", "text": "1.  In contrast to most other works on causality in LLMs, focusing on  commonsense causal knowledge , our goal is to assess the LLMs’ ability to perform  formal causal reasoning (briefly reviewed in Section  2 ). 2.  We introduce CL ADDER  (Section  3 ), a dataset containing more than 10K causal questions, spanning all three rungs of the ladder of causation, several causal graphs, and various stories for verb aliz ation. 3.  We develop C AUSAL C O T (Section  4 ), a chain-of-thought prompting strategy to elicit formal causal reasoning in LLMs, inspired by the  causal inference engine . 4.  We perform extensive experiments on eight LLMs (Section  5 ), analyze fine-grained errors to showcase the limitations of LLMs in formal causal reasoning, and suggest directions for future research. ", "page_idx": 2, "bbox": [131, 116.19451904296875, 505, 255.2224578857422], "page_size": [612.0, 792.0]}
{"layout": 18, "type": "text", "text": "2 Preliminaries on Causal Inference ", "text_level": 1, "page_idx": 2, "bbox": [107, 265, 301, 277], "page_size": [612.0, 792.0]}
{"layout": 19, "type": "text", "text": "Our dataset design takes inspiration from the  Causal Inference Engine  as postulated by Pearl and Mackenzie  [ 66 ] , see also [ 59 ]. We begin with a brief overview of the causality framework by Pearl et al.  [ 67 ] .   This framework was largely developed within the field of artificial intelligence, and there- fore puts particular emphasis on  algorithmic  aspects of causal reasoning (e.g., [ 62 ])—which makes it particularly suited for our work, where we want to algorithmic ally generate ground truth answers to causal queries, without having to appeal to common sense to assess the correctness of an answer. ", "page_idx": 2, "bbox": [107, 284.1385498046875, 505, 350.6885070800781], "page_size": [612.0, 792.0]}
{"layout": 20, "type": "text", "text": "2.1 The Ladder of Causation ", "text_level": 1, "page_idx": 2, "bbox": [106, 357, 239, 369], "page_size": [612.0, 792.0]}
{"layout": 21, "type": "text", "text": "The  Ladder of Causation , introduced by Pearl and Mackenzie  [ 66 ] , is a proposed taxonomy, and hierarchy, of causal inference tasks [ 3 ]. It consists of three distinct rungs. ", "page_idx": 2, "bbox": [107, 371.83154296875, 505, 394.7455139160156], "page_size": [612.0, 792.0]}
{"layout": 22, "type": "text", "text": "Rung 1 ( “seeing” ). This describes statistical associations ( “How often do I take an aspirin when I have a headache?” ). Rung 1 deals with statistical dependence s among random variables, and involves probabilistic reasoning about joint and conditional distributions,    $P(X=x,Y=y)$   and  $P(Y=y|X=x)$  , which can be formalised through  Bayesian Networks  [ 12 ,  58 ] representing a set of variables and their conditional dependencies via a directed acyclic graph (DAG). ", "page_idx": 2, "bbox": [107, 398.55804443359375, 505, 454.5975036621094], "page_size": [612.0, 792.0]}
{"layout": 23, "type": "text", "text": "Rung 2 ( “doing” ). This enables us to formalize the concept of actively intervening in the world, and modifying it toward some end ( “If I take an aspirin now, will my headache subside?” ). Interventions can be formalized using the  do-operator  [ 24 ] and  Causal Bayesian Networks  [ 67 ] to represent, for example, the distribution over  $Y$   when intervening on    $X$   to set its value to  $x$   as  $P(Y=y|\\mathrm{\\bar{do}}(X=x))$  . ", "page_idx": 2, "bbox": [107, 458.4100646972656, 505, 504], "page_size": [612.0, 792.0]}
{"layout": 24, "type": "text", "text": "Rung 3 ( “imagining” ). This rung deals with counter factual reasoning, i.e., reasoning about alter- native scenarios in which the world could have been different, possibly even contradicting the factual state ( “Would my headache have subsided, if I had taken an aspirin?” ). Counter factual probabilities can be written as  $P(Y_{x}=y)$  , representing the probability that “  $\\because$  would be  $y$  , had    $X$   been  $x\"$  . Reason- ing about Rung 3 quantities requires the introduction of  Structural Causal Models (SCMs)  [ 67 ]. SCMs are especially powerful as they enable any quantity in Rungs 1, 2, and 3 to be formulated precisely [ 3 ]. ", "page_idx": 2, "bbox": [107, 507.35406494140625, 505, 574.302490234375], "page_size": [612.0, 792.0]}
{"layout": 25, "type": "text", "text": "2.2 Causal Inference ", "text_level": 1, "page_idx": 2, "bbox": [107, 581, 203, 592], "page_size": [612.0, 792.0]}
{"layout": 26, "type": "text", "text": "Identification. Causal inference is especially difficult since we typically only have measurements from  lower  rungs, but want to reason about  higher  ones. A crucial question is then under what conditions are such inferences possible, i.e., what assumptions and measurements are required to unambiguously answer a causal query of interest: this is the question of  identification . As argued in [ 3 ],  “it is generically impossible to draw higher-layer inferences using only lower-layer information” . One may be able to draw inferences at a higher layer given a combination of partial knowledge of the underlying SCM, in the form of a causal graph, and data at lower layers. The graphical structure therefore plays a crucial role in bridging the rungs of the Ladder of Causation, and many prior works have been dedicated to exploiting properties of the graph to transform higher-rung queries into expressions which can be estimated based on lower-rung quantities [ 36 ,  64 ,  84 ]. ", "page_idx": 2, "bbox": [107, 593.9959106445312, 505, 704.5404663085938], "page_size": [612.0, 792.0]}
{"layout": 27, "type": "image", "page_idx": 3, "img_path": "layout_images/2312.04350v3_1.jpg", "img_caption": "Figure 2: The data-generating process of the CL ADDER  dataset. The upper part of the figure describes the formal part  of the question generation, which samples inputs for the CI Engine and derives a ground truth answer. The bottom part describes the  natural language part  of the question generation—i.e., its verb aliz ation, based on multiple stories and different degrees of alignment with commonsense knowledge. ", "bbox": [105, 70, 506, 394], "page_size": [612.0, 792.0], "ocr_text": "/— Formal Part of the Question Generation >\n\nSample a causal graph Sample a query type Generate\nP lial si ili available data\nt v\nCommon causal graphs with treatment-effect (X-Y) pairs Rung 1: Association Observational:\n* Marginal prob. Conditional prob. .\nral\nConfounding: ran Diamond: OS o>” Rung 2: Intervention Interventional:\ne * ATE ¢ Valid adjustment set E[...|do(...)] =...\n6 sO >Y) Chain: X—>O Rung 3: Counterfactuals\n4 x we  Counterfactual prob. ¢ ATT\n®>® NDE NIE\nCollision: “> Fork Po) ‘YMap to the estimand\n< ATE = E[Y| do(X=1)] - E[Y |do(X=0)]\n\nApply do-calculus given the causal graph\na Generate the data s.t.\n=Ip-,P(2=2)E(Y |X=1,Z=2)- the estimand is|identifiable\nLO : example option to choose EY |X =0,2=2)] J)\n\nNatural Language Part of the Question Generation\n\nSample a degree of alignment | ____+ Sample a story for\nwith common sense variable name instantiation\nu u\nLevels of Empirical Alignment Stories (Variable Name Instantiations) Verbalize the\n\nFor Commonsensical Confounding Graphs: entire question\n\n© Story 1: X=vaccine, Z=vulnerability, Y=fatality rate\n@ Story covery\n© Story 3: recovery\n\n Commonsensical «\n Anti-commonsensical\nNonsensical\n\n", "vlm_text": "The image shows a flowchart describing the data-generating process for the CL ADDER dataset, divided into two main parts:\n\n1. **Formal Part of the Question Generation:**\n   - **Sample a causal graph:** Options include common graphs such as confounding, mediation, collision, diamond, chain, and fork.\n   - **Sample a query type:** This can be association, intervention, or counterfactuals, with estimands like Average Treatment Effect (ATE).\n   - **Generate available data:** Includes observational and interventional data, applying do-calculus for identifiability.\n\n2. **Natural Language Part of the Question Generation:**\n   - **Sample a degree of alignment with commonsense knowledge:** Includes commonsensical (e.g., smoking causes cancer), anti-commonsensical, and nonsensical.\n   - **Sample a story for variable name instantiation:** Example stories align with causal graphs, such as \"X=vaccine, Z=vulnerability, Y=fatality rate\" for a commonsensical confounding graph.\n  \nThe process results in the verbalization of the entire question by aligning formal and natural language aspects."}
{"layout": 28, "type": "text", "text": "Causal Inference Engine. An over arching objective of this research is the construction of a  Causal Inference Engine (CI Engine)  [ 37 ,  59 ,  66 ], which takes as input a query, a graph, and some available data (typically from lower rungs than the query); and outputs whether a solution exists, and, if so, an equivalent expression of the query which is estimable from the available data. While some previous works refer to the CI engine in the context of Rung 2 queries, where it corresponds to the do -calculus [ 36 ,  84 ], here we refer to it in a more general sense, encompassing all three rungs. ", "page_idx": 3, "bbox": [107, 412.83392333984375, 505, 479.74249267578125], "page_size": [612.0, 792.0]}
{"layout": 29, "type": "text", "text": "3 Composing the CL ADDER  Dataset ", "text_level": 1, "page_idx": 3, "bbox": [106, 490, 303, 506], "page_size": [612.0, 792.0]}
{"layout": 30, "type": "text", "text": "Task Formulation. Like in the examp of Figure  1 , our  $\\mathcal{D}:=\\{(\\pmb{q}_{i},\\pmb{a}_{i},\\pmb{e}_{i})\\}_{i=1}^{N}$    consists of    $N$   triples, each containing a question  $\\mathbf{\\nabla}q_{i}$  , binary answer  $a_{i}\\in\\{\\mathbf{Yes,No}\\}$    } , and an explanation  $e_{i}$  . Our main task is to test the accuracy of the prediction function  $f:q\\mapsto a$   7→ , i.e., a LLM which maps a natural language causal question to an answer. Apart from directly evaluating the answer, we also compose the ground-truth explanations    $e$   to evaluate the reasoning steps of LLMs. ", "page_idx": 3, "bbox": [107, 512.9389038085938, 505, 568.9385375976562], "page_size": [612.0, 792.0]}
{"layout": 31, "type": "text", "text": "Design Principles. In the composition of our dataset, we adhere to the following design principles. First, we ensure broad coverage of all rungs of the ladder of causation. Second, we avoid settings that involve continuous variables and use binary variables instead: this is partly due to the large availability of ident if i ability results for binary and categorical variables, and partly because queries involving binary variables lend themselves to more natural-sounding verb aliz ation. Moreover, since LLMs strug- gle with calculation-heavy tasks [ 32 ,  91 ], and we are chiefly interested in causal reasoning abilities, we focus on graphs with few (three to four) variables, in various common configurations, to produce questions which are identifiable from the outset. Lastly, we carefully design a rich set of templates to translate the abstract formulas into grammatically correct and natural-sounding, fluent prompts. ", "page_idx": 3, "bbox": [107, 575.27392578125, 505, 674.9105224609375], "page_size": [612.0, 792.0]}
{"layout": 32, "type": "text", "text": "Overall Pipeline. The generation pipeline for CL ADDER , depicted in Figure  2 , consists of two parts: ", "page_idx": 3, "bbox": [107, 681.2459106445312, 505, 694.2072143554688], "page_size": [612.0, 792.0]}
{"layout": 33, "type": "text", "text": "1.  In the  Formal Part  (which we illustrate in Section  3.1 ), we specify all the required inputs (query, model, data) and the ground truth answer generated by the CI Engine. ", "page_idx": 3, "bbox": [107, 699.8855590820312, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 34, "type": "text", "text": "2.  In the  Natural Language Part  (in Section  3.2 ), we verbalize the formal queries and specification of the causal model and data by associating them to a story or narrative, using a rich set of templates. ", "page_idx": 4, "bbox": [106, 72.757568359375, 505, 95.67150115966797], "page_size": [612.0, 792.0]}
{"layout": 35, "type": "text", "text": "3.1 Formal Part of the Question Formulation ", "text_level": 1, "page_idx": 4, "bbox": [106, 105, 310, 118], "page_size": [612.0, 792.0]}
{"layout": 36, "type": "text", "text": "The first step of our data generating process is to construct a set of inputs to the CI Engine such that  by design  there exists a well-defined ground truth answer: i.e., we construct triples of causal queries, graphs, and data such that the query can be unambiguously answered based on the available data (ensuring  ident if i ability  by construction).   The ground truth causal models, which specify all quantities which are considered measurable in our questions, are causal Bayesian networks (CBNs), where each causal mechanism (i.e., conditional probability of a variable given its parents in the factorization according to the causal graph  $G$  ) corresponds to a Bernoulli distribution. We compile a selection of graphs  $G$   based on examples drawn from multiple sources from the literature [ 66 ,  67 , 69 ,  88 ], where suitable graph structures are used to illustrate toy problems in causal inference. The complete list of structures we consider can be found in Appendix  A.3 ; the complete list of sources in Appendix  A.1 . ", "page_idx": 4, "bbox": [106, 121.467529296875, 505, 242.56346130371094], "page_size": [612.0, 792.0]}
{"layout": 37, "type": "text", "text": "Selecting Query Types. We again draw from the causal inference literature to collect common query types in each rung. As illustrated in the  “Sample a query type”  box in Figure  2 , for Rung 1, we can ask about probability distributions such as marginal probabilities and conditional probabilities. For Rung 2 questions, we can enquire  average treatment effects (ATE)  ( “how will    $Y$   change if    $X$  changes from    $x$   to  $x^{\\prime}\\!\\!\\stackrel{_{.}}{?}$  ), or what constitutes a valid adjustment set that can block all backdoor spurious correlations between  $X$   and  $Y$  . Lastly, for Rung 3, we include  counter factual s  ( “what would happen to  $Y$   had    $X$   been    $x^{\\prime}$    instead of    $x?\")$  ),  average treatment effect on the treated (ATT) ( “for the sub population whose    $X$   changed from    $x$   to    $x^{\\prime}$  , how does their  $Y$   change on average?” ), natural direct effect (NDE)  ( “what is the direct effect of  $X$   in  $Y$  , but not through the mediator?” ), and  natural indirect effect (NIE)  ( “what is the effect from    $X$   to  $Y$  through the mediator?” ). ", "page_idx": 4, "bbox": [106, 249.8339080810547, 505, 360.3794860839844], "page_size": [612.0, 792.0]}
{"layout": 38, "type": "text", "text": "Applying the Causal Inference Engine for the Ground-truth answer. By construction, the causal processes we define encapsulates all necessary information to make the causal quantities of the query types identifiable. This allows us to apply the rules of causal inference to obtain an estimand for each causal graph and query type, and evaluate the estimand to get a ground truth answer. The Rung 2 queries simplify to Rung 1 terms using the rules of  $d o$  -calculus [ 59 ], and, for the Rung 3 queries, we apply methods of counter factual causal inference [ 67 ] (with details in Appendix  C.3 ). The estimand also specifies exactly which terms are necessary to include in the prompt as  “available data”  in order to ensure that enough information is provided to answer the question correctly (i.e., for ident if i ability), provided the correct causal reasoning is applied. Our entire code base of the data generation process can be found at our GitHub repository,  https://github.com/causalNLP/cladder . ", "page_idx": 4, "bbox": [106, 367.64892578125, 505, 478.9815368652344], "page_size": [612.0, 792.0]}
{"layout": 39, "type": "text", "text": "3.2 Natural Language Part of the Question Formulation ", "text_level": 1, "page_idx": 4, "bbox": [107, 488, 354, 500], "page_size": [612.0, 792.0]}
{"layout": 40, "type": "text", "text": "While Section  3.1  describes a way to generate the ground-truth causal model, query and answers, com- puted through a causal inference engine, real-world causal reasoning problems are expressed in natural language rather than symbolic expressions. The next part of the data generation pipeline therefore focuses on the verb aliz ation of all these components with a plausible narrative in natural language. ", "page_idx": 4, "bbox": [106, 503.9915771484375, 505, 548.7235107421875], "page_size": [612.0, 792.0]}
{"layout": 41, "type": "text", "text": "Generating the Stories. For each causal graph, we collect a set of two to five  stories  which consist of a list of variable names for each node in the graph. The stories are primarily selected from examples in commonly cited causal inference books and papers (see Appendix  A.1 ), which ensures that the stories and corresponding causal graph structures adhere to empirical common sense (e.g., the drug- gender-recovery example of Pearl and Mackenzie  [ 66 ] ). However, it is very likely that at least some of the stories appear in the training data of many LLMs. Therefore, we also generate various  anti- common sense  and  nonsensical  variants of the stories, meant to isolate the effects of memorization. For the anti-common sens ical stories, we randomly do one of the actions: (1) replace the effect variable  $Y$   with an unusual attribute, that would not be an effect variable in any of the stories (e.g., “ear shape”); or (2) create an irrelevant treatment variable    $X$   that does not play a causal role in any of our common sens ical stories, such as “playing card games” (see Appendix  A.7 ). For the nonsensical variants, we invent artificial words as variable names such as “zory” and “qixy” (see Appendix  A.6 ). . ", "page_idx": 4, "bbox": [106, 555.993896484375, 505, 688.3574829101562], "page_size": [612.0, 792.0]}
{"layout": 42, "type": "text", "text": "Verbalizing the Prompts. The verb aliz ation procedure applies the mapping of symbolic variables to semantic concepts to form a plausible narrative for the underlying causal process and then translates the symbolic expressions from the underlying causal process to natural language using carefully designed templates. ", "page_idx": 5, "bbox": [106, 72.39891815185547, 505, 117.48949432373047], "page_size": [612.0, 792.0]}
{"layout": 43, "type": "text", "text": "Specifically, we use several different grammatical forms for each semantic concept    $t$   in the story to make the resulting prompt sound natural and grammatically correct. We first have the overall variable name    $v_{\\mathrm{overall}}(t)$  , the recovery status), and, then, for each binary   $i\\in\\{0,1\\}$  , we compose its noun  $v_{\\mathrm{moon}}(t=i)$   (e.g., recovery), verb (e.g., to recover), sentence  $v_{\\mathrm{sent}}({\\pmb t}=i)$   (e.g., the patients recover), noun with attributive clause    $v_{\\mathrm{{att}}}(\\mathbfit{t}=\\boldsymbol{i})$   (e.g., patients who recover), and third conditional  $v_{\\mathrm{cond}}(\\mathbf{\\dot{t}}=\\dot{\\iota})$   (e.g., if the patient had recovered). ", "page_idx": 5, "bbox": [106, 121.8985595703125, 505, 189], "page_size": [612.0, 792.0]}
{"layout": 44, "type": "text", "text": "Using these elements, we first verbalize the causal graph by iterating through each node and its outgoing edges, using the template   $^{**}$   has a direct effect on  $\\mathbf{CH}(t){}\"$     $\\mathbf{CH}(\\cdot)$   denotes the set of direct effects (children) of a variable. Then, for the available data  d , we verbalize each conditional probability by “For    $v_{\\mathrm{{att}}}(t_{m}\\;=\\;i)$  , the probability of    $v_{\\mathrm{ Ḋ n Ḍ }}(t_{n}\\,=\\,1)$   is    $p$  .”, and each marginal probability by “The overall probability of  $v_{\\mathrm{{att}}}(t=1)$   is  $p$  .” Note that our distributions are Bernoulli, so it is adequate to just introduce the parameter  $p$  , which is the likelihood of    $t=1$  . For example, we generate sentences such as “The overall probability of recovery is  $60\\%$  .” and “For patients who have small kidney stones, the probability of recovery is   $70\\%$  .” Finally, for the query  $\\pmb q$  , we instantiate each query type in our dataset following our question templates in Appendix  A.5  such that the questions can always be answered with “yes” or “no”. ", "page_idx": 5, "bbox": [106, 192.85858154296875, 505, 303.0455017089844], "page_size": [612.0, 792.0]}
{"layout": 45, "type": "text", "text": "Generating the Explanations. Apart from the question-answer pairs, we also generate the step-by- step explanations. Our goal is to provide all intermediate reasoning steps a student of causal inference would use to answer the questions, so that each necessary subskill necessary for causal inference can be evaluated individually. We identify the following six subskills:    $\\textcircled{1}$  causal graph extraction;  $\\circledast$  correct query type interpretation;    $\\textcircled{3}$  symbolic formalization of the query;    $\\clubsuit$  semantic parsing to compile the available data;  $\\mathfrak{G}$  estimand derivation; and    $\\mathfrak{G}$  arithmetic calculation to solve the estimand, as in the colored boxes in Figure  1 . Our explanation  $e$   verbalizes all the elements  $^{\\textregistered}$  as sequential steps using our template in Appendix  A.8 . ", "page_idx": 5, "bbox": [106, 307.2809143066406, 505, 396.0085144042969], "page_size": [612.0, 792.0]}
{"layout": 46, "type": "text", "text": "3.3 Dataset Statistics ", "text_level": 1, "page_idx": 5, "bbox": [107, 403, 205, 414], "page_size": [612.0, 792.0]}
{"layout": 47, "type": "text", "text": "Our data-generating procedure has the potential to algorithmic ally generate a vast large number of questions. In practice, we pick a dataset size that is large enough to be representative, and at the same time not too large to be problematic given the expensive inference costs of LLMs. We therefore set our dataset size to be 10K, and report the statistics in Table  1 . ", "page_idx": 5, "bbox": [106, 417.55755615234375, 505, 462.2904968261719], "page_size": [612.0, 792.0]}
{"layout": 48, "type": "text", "text": "The dataset roughly balance across the query types, graph structures, stories, and ground truth answers (as seen in Figure  3 ). Note that some causal queries are only compatible with a subset of the graphs, thereby resulting in a slightly lower representation of those queries (such as the NDE and NIE). More details on our design choices can be found in Appendix  A.4 . ", "page_idx": 5, "bbox": [106, 466.6995544433594, 505, 511.4314880371094], "page_size": [612.0, 792.0]}
{"layout": 49, "type": "table", "page_idx": 5, "img_path": "layout_images/2312.04350v3_2.jpg", "table_footnote": "Table 1: Statistics of our CL ADDER  dataset v1.5. ", "bbox": [106, 520, 365, 674], "page_size": [612.0, 792.0], "ocr_text": "Total | Rung! Rung2  Rung3\n\nSize\n\n# Samples 10,112 | 3,160 3,160 3,792\nQuestion\n\n# Sentences/Sample 6.01 5.88 5.37 6.65\n\n# Words/Sample 80.9 73.43 76.95 90.42\n\n# Nodes/Graph 3.52 3.5 3.5 3.54\n\n# Edges/Graph 3.38 353) 3.3 3.5\nAnswer\n\nPositive Class (%) 50 50 50 50\nExplanations\n\n# Sentences/Sample 9.11 9.1 8.1 9.96\n\n# Words/Sample 47.95 49.87 32.8 58.97\n\n", "vlm_text": "The table provides a breakdown of a dataset across three categories labeled as \"Rung 1,\" \"Rung 2,\" and \"Rung 3,\" along with an overall \"Total\" category.\n\nHere are the contents:\n\n1. **Size**\n   - Total number of samples in the dataset: 10,112\n   - Number of samples in each rung:\n     - Rung 1: 3,160\n     - Rung 2: 3,160\n     - Rung 3: 3,792\n\n2. **Question**\n   - Average number of sentences per sample:\n     - Total: 6.01\n     - Rung 1: 5.88\n     - Rung 2: 5.37\n     - Rung 3: 6.65\n   - Average number of words per sample:\n     - Total: 80.9\n     - Rung 1: 73.43\n     - Rung 2: 76.95\n     - Rung 3: 90.42\n   - Average number of nodes per graph:\n     - Total: 3.52\n     - Rung 1: 3.5\n     - Rung 2: 3.5\n     - Rung 3: 3.54\n   - Average number of edges per graph:\n     - Total: 3.38\n     - Rung 1: 3.3\n     - Rung 2: 3.3\n     - Rung 3: 3.5\n\n3. **Answer**\n   - Percentage of positive class samples: 50% across all rungs and total\n\n4. **Explanations**\n   - Average number of sentences per sample:\n     - Total: 9.11\n     - Rung 1: 9.1\n     - Rung 2: 8.1\n     - Rung 3: 9.96\n   - Average number of words per sample:\n     - Total: 47.95\n     - Rung 1: 49.87\n     - Rung 2: 32.8\n     - Rung 3: 58.97\n\nThe table provides statistical measures related to the structure and characteristics of the samples, questions, answers, and explanations within the dataset, distributed across different rungs."}
{"layout": 50, "type": "image", "page_idx": 5, "img_path": "layout_images/2312.04350v3_3.jpg", "img_caption": "Figure 3: Distributions of query types in our 10K data. ", "bbox": [403, 546, 506, 674], "page_size": [612.0, 792.0], "ocr_text": "Countert.\n\n", "vlm_text": "The image is a circular chart with three concentric segments, each labeled as \"Rung 1\", \"Rung 2\", and \"Rung 3\". These segments appear to represent different categories or types of queries. Each rung is divided into sections labeled as follows:\n\n- Rung 1: \n  - \"Cond. Prob.\" (Conditional Probability)\n  - \"Marg. Prob.\" (Marginal Probability)\n\n- Rung 2: \n  - \"ATE\" (Average Treatment Effect)\n  - \"Adjust. Set\" \n\n- Rung 3:\n  - \"NIE\" (Natural Indirect Effect)\n  - \"NDE\" (Natural Direct Effect)\n  - \"ATT\" (Average Treatment effect on the Treated)\n  - \"Counterf.\" (Counterfactual)\n\nThe colors transition from blue in Rung 1 to shades of orange/red in Rungs 2 and 3, suggesting a progression or hierarchy among the query types. The chart is labeled as \"Figure 3: Distributions of query types in our 10K data.\" This could suggest that the figure categorizes and visualizes the distribution of different query types that are part of a dataset consisting of 10,000 entries."}
{"layout": 51, "type": "text", "text": "3.4 Data Quality Check ", "text_level": 1, "page_idx": 5, "bbox": [107, 685, 216, 697], "page_size": [612.0, 792.0]}
{"layout": 52, "type": "text", "text": "Our dataset is generated through an algorithmic procedure, which has the following potential benefits: formal correctness; zero human annotation cost; and, most importantly, control l ability—e.g., for the question distribution, as well as for making it more unlikely that the data was previously seen by the model. However, since the dataset is different from common NLP datasets collected from human natural language writing, we also need to perform additional data quality checks. We therefore checked for a list of non-formal, natural language properties: grammatical it y; human readability; naturalness/perplexity; and how well humans perform on this task. ", "page_idx": 5, "bbox": [108, 699.8855590820312, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 53, "type": "text", "text": "", "page_idx": 6, "bbox": [107, 72.757568359375, 505, 128.3984832763672], "page_size": [612.0, 792.0]}
{"layout": 54, "type": "text", "text": "For grammatical it y, we ran a grammatical error check on our dataset using the Language Tool package [ 51 ], and got on average 1.26 grammatical errors per 100 words (i.e.,   $98.74\\%$   correctness), which shows that most of the language in our dataset follows English grammar. For human readability, we checked how comprehensible the questions are to students who have taken causality courses. We selected a random subset of 50 questions from the dataset, and let a graduate student annotator go through the questions to judge whether they could understand them or not:  $96\\%$   of the questions were deemed readable. Next, for the naturalness/perplexity score, we used the open-sourced GPT-2 model and obtained a perplexity score of 21.17 on our dataset, which is substantially lower (i.e., closer to the distribution of natural human-written text) than the one of MATH [ 32 ], a commonly used dataset of maths questions. Lastly, we conducted a sanity check where one expert evaluator tried to solve a random sample of 50 questions from the dataset, and we recorded an accuracy of   $82\\%$   on this task. ", "page_idx": 6, "bbox": [107, 133.26153564453125, 505, 254.3574676513672], "page_size": [612.0, 792.0]}
{"layout": 55, "type": "image", "page_idx": 6, "img_path": "layout_images/2312.04350v3_4.jpg", "img_caption": "4 Our C AUSAL C O T Model ", "bbox": [107, 264, 501, 500], "page_size": [612.0, 792.0], "ocr_text": "ee\n\nOur Causal Chain-of-Thought (CausalCoT) Model:\n\nGuidance: Address the question by following the steps below:\n=. Extract the causal graph.\n4 i Average Treatment Effect (ATE)\nPreparation Step 2] Determine the query type. ig) (ATE)\nPhase ‘ii1-)<) Formalize the query.\n\n[step 4] Gather all relevant data.\n\nJ\n\n4\nDeduce the estimand using causal inference: Given all the information above, deduce the estimand\nusing skills such as do-calculus, counterfactual prediction, and the basics of probabilities.\n\nSolution J = Ez=7 P(Z=z) [P(Y=1|Z=z,X=1)-P(Y=1|Z=z, X=0)] (Apply backdoor adjustment formula)\n\nPhase\nCalculate the estimand: Insert the relevant data in Step 4 into the estimand, perform basic arithmetic\n\ncalculations, and derive the final answer.\n+ ATE(X) =... = -0.021 <0\n\no\nBo]\n\nBased on all the reasoning above, output one word to answer the initial question with just \"Yes\" or \"|\n\nFinal answer: No\n", "vlm_text": "The image displays a visual representation of the Causal Chain-of-Thought (CausalCoT) Model, which is a methodological framework for answering a causal inference question. The model is divided into two main phases: the Preparation Phase and the Solution Phase, followed by delivering a final answer.\n\n1. **Preparation Phase**: \n   - **Step 1**: Extract the causal graph.\n   - **Step 2**: Determine the query type.\n   - **Step 3**: Formalize the query.\n   - **Step 4**: Gather all relevant data.\n\n2. **Solution Phase**:\n   - **Step 5**: Deduce the estimand using causal inference techniques like do-calculus, counterfactual prediction, and the basics of probabilities.\n   - **Step 6**: Calculate the estimand by inserting relevant data into the estimand formula, performing calculations, and deriving the final answer.\n\n3. **Final Question**: Using the reasoning, provide a final answer to the initial question with either \"Yes\" or \"No\". \n\nThe specific question addressed in this model is the Average Treatment Effect (ATE), expressed as \\(E[Y|do(X=1)] - E[Y|do(X=0)]\\), with a small detailed causal graph involving variables X, Y, and Z. The image also includes notation and calculations, showing the final result for ATE as -0.021, which leads to the final answer being \"No\"."}
{"layout": 56, "type": "text", "text": "In order to guide LLMs in correctly answering the questions in CL ADDER , we draw inspiration from the ideal functioning of the CI engine [ 66 ], which breaks down a causal reasoning problem into multiple symbolically-grounded, simpler steps. We develop C AUSAL C O T, a multi-step causal chain-of-thought prompt in Figure  4 , which combines formal causal reasoning skills with the idea of chain-of-thought prompting [ 96 ] and the use of scratch pads for solving more complicated problems requiring a long list of steps [ 55 ] for LLMs. ", "page_idx": 6, "bbox": [107, 543.0225830078125, 505, 609.572509765625], "page_size": [612.0, 792.0]}
{"layout": 57, "type": "text", "text": "We base our prompt design on the multi-step reasoning process of causal inference as shown in Figure  4 , first starting with four preparation steps:    $\\textcircled{1}$  identifying the causal graph structure;    $\\circledast$  determining the causal query type; 6  $\\textcircled{3}$  formulating the query symbolically precisely; and    $\\clubsuit$  extracting relevant data from the prompt. Then, given all the information collected in the preparation stage, we introduce the formal solution:    $\\mathfrak{G}$  correctly deducing the estimand using causal inference techniques; and finally    $\\mathfrak{G}$  evaluating the estimand to answer the question. This set of steps require both  natural language understanding  to parse the question (as in most steps in the preparation phase), as well as formal causal reasoning  to derive the correct estimand (as in the solution phase). ", "page_idx": 6, "bbox": [107, 614.4365234375, 505, 702.8045043945312], "page_size": [612.0, 792.0]}
{"layout": 58, "type": "text", "text": "We build our C AUSAL C O T prompting strategy using GPT-4 [ 56 ], a recent auto regressive LLM that achieves state-of-the-art performance on many tasks. This latest model builds upon the previous series of general pretrained models (GPT) [ 7 ,  76 ] and adds reinforcement learning with human feedback, or instruction-tuning [ 1 ,  57 ,  104 ], to align the model responses to free-form questions with human preferences. It has achieved human-competitive performance over a list of tasks [ 8 ,  43 ,  54 ,  56 ,  105 ], among which the more formal tasks unseen in the training data still remain elusive [ 42 ,  78 ,  91 ]. ", "page_idx": 7, "bbox": [107, 72.757568359375, 505, 139.30747985839844], "page_size": [612.0, 792.0]}
{"layout": 59, "type": "text", "text": "Given a causal question  $\\pmb q$  , we provide the LLM a list of instructions    $\\ell:=(\\pmb{s}_{1},.\\,.\\,.\\,,\\pmb{s}_{6})$   consisting of the detailed descriptions of the six  $s_{1},\\ldots,s_{6}$   in Figure  4 . As the model    $f_{\\mathrm{LLM}}:s_{i}\\mapsto\\pmb{r}_{i}$  auto regressive ly produces responses  $r_{1},\\cdot\\cdot\\cdot\\ ,r_{6}$   · · ·  sequentially corresponding to the six steps, we concatenate all the above before asking the final question “Based on all the reasoning above, output one word to answer the initial question with just ‘Yes’ or ‘No’.” See the complete prompt in Appendix  B.1 . In the end, we obtain the binary answer  $a\\in\\{\\mathrm{Yes,No}\\}$   as the final result. ", "page_idx": 7, "bbox": [107, 143.66656494140625, 505, 210.2164764404297], "page_size": [612.0, 792.0]}
{"layout": 60, "type": "text", "text": "Compared with the standard strategy of directly prompting the LLMs a question, we impose an inductive bias  upon LLMs by using the causal inference framework, thus incorporating some of the powerful, principled insights of the causal inference community for NLP tasks. In this way, we enhance the strong natural language ability of LLMs with formal causal reasoning skills. ", "page_idx": 7, "bbox": [107, 214.5755615234375, 505, 259.3074951171875], "page_size": [612.0, 792.0]}
{"layout": 61, "type": "text", "text": "5 Testing LLMs with CL ADDER ", "text_level": 1, "page_idx": 7, "bbox": [106, 268, 283, 281], "page_size": [612.0, 792.0]}
{"layout": 62, "type": "text", "text": "5.1 Experimental Setup ", "text_level": 1, "page_idx": 7, "bbox": [106, 289, 217, 301], "page_size": [612.0, 792.0]}
{"layout": 63, "type": "text", "text": "Our empirical investigation focuses on some of the most recent language models. We include the latest GPT-4 [ 56 ] with 1T parameters by the time we conduct the experiments (i.e., gpt-4-1106-preview), the previous ChatGPT (i.e., GPT-3.5) with 175B parameters, and then a series of earlier models with instruction-tuning on the 175B GPT-3 (text-davinci-001, -002, and -003) [ 57 ]. As baselines, we also include the non-instruction-tuned GPT-3 (davinci). We use the OpenAI API with temperature 0 when querying these models. We also include open-source, more efficient models like LLaMa [ 93 ] and its instruction-tuned version Alpaca [ 92 ], both with the same number of parameters, 6.7B. ", "page_idx": 7, "bbox": [107, 303.716552734375, 505, 381.1755065917969], "page_size": [612.0, 792.0]}
{"layout": 64, "type": "table", "page_idx": 7, "img_path": "layout_images/2312.04350v3_5.jpg", "table_caption": "5.2 Main Results ", "table_footnote": "Table 2: Performance of all models on our CL ADDER  dataset v1.5. We report the overall accuracy (Acc.), and also fine-grained accuracy by rung, and by degree of commonsense alignment, from common sens ical (Comm.), nonsensical (Nonsens.), to anti-common sens ical (Anti-C.). ", "bbox": [106, 387, 511, 562], "page_size": [612.0, 792.0], "ocr_text": ". Acc. by Rung Acc. by Commonsense Alignment\nOverall Ace. 1 2, 3 Comm. _Nonsens. Anti-C.\nRandom 49.27 50.28 48.40 49.12 | 49.01 49.69 49.12\nLLaMa 44.03 48.23 29.46 52.66 | 45.14 522 42.67\nAlpaca 44.66 52.03 29.53 51.13 | 44.86 40 44.77\nGPT-3 Non-Instr. (davinci) 49.92 50.00 49.75 50.00 | 49.06 49.97 50.72\nGPT-3 Instr. (text-davinci-001) 51.40 51.30 52.63 50.47 | 54.31 50.13 50.05\nGPT-3 Instr. (text-davinci-002) 53.15 50.85 56.96 51.90 | 55.33 52.47 51.81\nGPT-3 Instr. (text-davinci-003) 56.26 S1.11 62.97 54.96 | 56.83 54.79 57.49\nGPT-3.5 52.18 51.80 54.78 50.32 | 54.09 50.68 52.09\nGPT-4 62.03 63.01 62.82 60.55 | 62.27 63.09 60.47\n+ CAUSALCOT 70.40 83.35 67.47 62.05 | 69.25 71.58 70.12\n\n", "vlm_text": "The table presents accuracy metrics for various models evaluated in different categories:\n\n1. **Overall Acc. (Accuracy):**\n   - Random: 49.27\n   - LLama: 44.03\n   - Alpaca: 44.66\n   - GPT-3 Non-Instr. (davinci): 49.92\n   - GPT-3 Instr. (text-davinci-001): 51.40\n   - GPT-3 Instr. (text-davinci-002): 53.15\n   - GPT-3 Instr. (text-davinci-003): 56.26\n   - GPT-3.5: 52.18\n   - GPT-4: 62.03\n   - + CAUSALCoT: 70.40\n\n2. **Acc. by Rung:**\n   - Models are evaluated over three rungs with the following accuracies:\n     - Rung 1: Highest achieved by +CAUSALCoT at 83.35\n     - Rung 2: Highest achieved by +CAUSALCoT at 67.47\n     - Rung 3: Highest achieved by +CAUSALCoT at 62.05\n\n3. **Acc. by Commonsense Alignment:**\n   - Models are tested on three categories:\n     - Comm.: Highest with GPT-4 at 62.27\n     - Nonsens.: Highest with +CAUSALCoT at 71.58\n     - Anti-C.: Highest with +CAUSALCoT at 70.12\n\nThe overall trend shows increasing accuracy through different versions of the GPT models, with the best performance achieved by GPT-4 and further improved with +CAUSALCoT."}
{"layout": 65, "type": "text", "text": "We compare the performance of all models in Table  2 . First, we can see that the causal reasoning task in CL ADDER  is in general very challenging for all models. Models such as the earlier, non-instruction- tuned GPT-3, and both LLaMa and Alpaca are around random performance. With instruction-tuning, models start to show some improvement. And amongst all, our C AUSAL C O T achieves the highest performance of  $70.40\\%$  , which is substantially better than the vanilla GPT-4 by 8.37 points. Moreover, C AUSAL C O T also achieve the best performance across all three rungs of causal questions, with a monotonically decreasing performance as the rungs get higher, i.e., the questions get more difficult. See Appendix  D  for experiments on our earlier dataset v1.0. ", "page_idx": 7, "bbox": [107, 568.49853515625, 505, 656.8665161132812], "page_size": [612.0, 792.0]}
{"layout": 66, "type": "text", "text": "5.3 Isolating the Effect of Data Contamination ", "text_level": 1, "page_idx": 7, "bbox": [107, 663, 313, 675], "page_size": [612.0, 792.0]}
{"layout": 67, "type": "text", "text": "A well-known problem with evaluating LLMs on question-answering tasks is the data contamination problem, i.e., that LLMs perform well on a test set because the test set is (unintentionally) contained partially or even entirely in the training data [ 7 ,  56 ]. We address this problem by creating not only the common sens ical subset of our dataset, but also anti-common sens ical and nonsensical, both of which, by construction, are very likely not in the training data of LLMs. From the accuracy by commonsense alignment degree in Table  2 , we can see the original GPT-4 model performs the worst on the anti- common sens ical subset (1.8 points lower than that on the common sens ical subset). However, our C AUSAL C O T enhances the reasoning ability across all levels, with substantial improvement on anti-common sens ical data by 9.65 points, highlighting the strength of C AUSAL C O T on unseen data. ", "page_idx": 7, "bbox": [107, 678.0675659179688, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 68, "type": "text", "text": "", "page_idx": 8, "bbox": [106, 72.757568359375, 505, 128.3984832763672], "page_size": [612.0, 792.0]}
{"layout": 69, "type": "table", "page_idx": 8, "img_path": "layout_images/2312.04350v3_6.jpg", "table_caption": "5.4 Error Analysis by Sub questions ", "table_footnote": "Table 3: Performance for each step in C AUSAL C O T. For Step  $\\overline{{\\circledast}}$  , we report the F1 score of node prediction, edge prediction, and also the graph edit distance (Dist.) with the true graph. See more details in Appendix  E.1 . ", "bbox": [105, 135, 504, 212], "page_size": [612.0, 792.0], "ocr_text": "Step © Step @ StepO@&® Step® Step ©\n\nNode Edge Dist. ({) Overall FI Rung 1 Rung 2 Rung 3 Estimand FI Arithmetic\n\n99.34 97.01 1.69 50.65 69.99 59.14 42.12 53 47.53 99\n\n", "vlm_text": "The table contains data related to different steps in a process, which seem to be numbered sequentially. Here's a breakdown of the data presented:\n\n- **Step ①**: \n  - **Node**: 99.34\n  - **Edge**: 97.01\n  - **Dist. (↓)**: 1.69\n\n- **Step ②**:\n  - **Overall F1**: 50.65\n  - **Rung 1**: 69.99\n  - **Rung 2**: 59.14\n  - **Rung 3**: 42.12\n\n- **Step ③ & ⑤**:\n  - **Estimand**: 53\n\n- **Step ④**:\n  - **F1**: 47.53\n\n- **Step ⑥**:\n  - **Arithmetic**: 99\n\nThe table seems to track various metrics (like F1 scores, node and edge percentages, distances) across multiple steps, potentially indicative of different stages or evaluations in a process."}
{"layout": 70, "type": "text", "text": "We conduct a fine-grained error analysis by looking into the performance of different steps of C AUSAL C O T in Table  3 .   We can see that the model is good at Step    $\\textcircled{1}$  to extract causal graph  $\\mathcal{G}$  , achieving high F1 scores for predicting both the nodes and the edges correctly, although not perfect, still leaving a graph edit distance of 1.69 between the ground truth causal graph and the model-identified graph. The other steps are more challenging for the model. Among those, Steps  $\\circledast$  ,  $\\textcircled{3}$  and  $\\mathfrak{G}$  require careful and correct application of causal inference, where the model struggles. This reveals a notable weakness of current LLMs to perform formal causal reasoning, which is an important direction for future work on improving and enhancing LLMs. To better understand the reasoning abilities of LLMs, we also perform an extensive analysis taking the entire reasoning chain of our C AUSAL C O T and the ground-truth explanations, to produce 20 fine-grained scores about the multi-step reasoning quality using the ROSCOE framework [ 25 ], and show detailed results in Appendix  E.2 . ", "page_idx": 8, "bbox": [106, 219.2745361328125, 505, 351.2795104980469], "page_size": [612.0, 792.0]}
{"layout": 71, "type": "text", "text": "5.5 Effect of In-Context Learning ", "text_level": 1, "page_idx": 8, "bbox": [106, 359, 259, 370], "page_size": [612.0, 792.0]}
{"layout": 72, "type": "text", "text": "As an additional analysis, we look into the effect of in-context learn- ing (ICL) by providing an example solution before asking the ques- tion. The interesting question to us is whether models can generalize across different query types. Namely, we keep our C AUSAL C O T framework, and prepend a reasoning example of query type    $i$  , and then calculate how much improvement it can bring when models answer new questions of query type  $j$  . In Figure  5 , we can see that conditional probability and NIE are the questions that benefit the most from ICL, and showing examples of marginal probability and ATT are among the most helpful to all questions in general. ", "page_idx": 8, "bbox": [107, 374.133544921875, 376, 484.32049560546875], "page_size": [612.0, 792.0]}
{"layout": 73, "type": "image", "page_idx": 8, "img_path": "layout_images/2312.04350v3_7.jpg", "img_caption": "Figure 5: Heatmap showing the how helpful each query type is to solving subsequent query types. ", "bbox": [383, 360, 506, 490], "page_size": [612.0, 792.0], "ocr_text": "Marg.\n\nCond.\n\nATE\nCount.\n\nATT\nNDE\n\nNIE\n", "vlm_text": "The image is a heatmap that visualizes how helpful each query type is in solving subsequent query types. The query types listed are \"Marg.\" (Marginal), \"Cond.\" (Conditional), \"ATE\" (Average Treatment Effect), \"Count.\", \"ATT\" (Average Treatment Effect on the Treated), \"NDE\" (Natural Direct Effect), and \"NIE\" (Natural Indirect Effect). The cells in the heatmap are colored in shades of blue, with a corresponding color bar indicating the numerical range from negative values to positive values. Darker shades typically represent higher values, either positively or negatively, indicating the level of helpfulness between the query types in solving subsequent queries."}
{"layout": 74, "type": "text", "text": "6 Related Work ", "text_level": 1, "page_idx": 8, "bbox": [106, 494, 199, 506], "page_size": [612.0, 792.0]}
{"layout": 75, "type": "text", "text": "Skill evaluation for LLMs. Our work may be seen as part of the literature aimed at evaluating the performance of current LLMs [ 7 ,  15 ,  56 ,  76 ,  103 ,  inter alia ], focusing on understanding their strengths and weaknesses. Various studies into the capabilities of LLMs [ 8 ,  39 ,  56 ,  74 ] change people’s perception of domains such as education [ 2 ,  80 ], medicine [ 54 ,  87 ], law [ 43 ], and computational social science [ 105 ]. However, most work evaluates new models on existing datasets from previously- curated large-scale benchmarks [ 89 ,  94 ,  95 ], or human exams [ 41 ,  43 ,  56 ] which is becoming increasingly unreliable due to training set contamination. ", "page_idx": 8, "bbox": [107, 512.48388671875, 505, 590.302490234375], "page_size": [612.0, 792.0]}
{"layout": 76, "type": "text", "text": "Causality-related skills for NLP. With the increasing attention on LLMs and causality [ 100 ,  101 ], we review several formulations of causality-related skills for NLP, which we summarize into (1) causality as knowledge, (2) causality as language comprehension, and (3) causality as reasoning. In the  causality-as-knowledge  line of work, many existing studies investigate how well NLP models understand commonsense causality, such as the cause and effect of an agent’s action [ 81 ], motivation and emotional reaction in a social context [ 82 ], correspondence of a set of steps with a high-level goal [ 102 ], development of a story given a different beginning [ 75 ], and how in general LLMs serve as a knowledge base of causality [ 100 ]. Concurrent work [ 45 ] focuses on evaluating LLMs on various causality related tasks by leveraging the conceptual knowledge accrued from the training data, rather than formal causal inference, except for their causal sufficiency analysis which is close to our counter factual questions. Importantly, most work in this line does not define explicit causal graphs, making it difficult to quantitatively define the ground-truth causal relationships in a principled way. The  causality-as-language-comprehension  line of work stems from traditional linguistic studies on causal connectives and causal language usage [ 9 ,  90 ,  99 ], to the recent causal relation extraction [ 4 ,  33 ,  98 ] to identify cause-effect pairs as a subtask of information extraction from text. ", "page_idx": 8, "bbox": [107, 594.4489135742188, 505, 694.0855102539062], "page_size": [612.0, 792.0]}
{"layout": 77, "type": "text", "text": "", "page_idx": 9, "bbox": [107, 72.757568359375, 505, 139.30747985839844], "page_size": [612.0, 792.0]}
{"layout": 78, "type": "text", "text": "Finally, for  causality as formal reasoning , our CL ADDER  work formulates the task of causal infer- ence for NLP, and our other work, C ORR 2C AUSE  [ 42 ], addresses the causal discovery problem to infer causation from correlation. Together, they cover the two major branches of causal reasoning investigated in existing technical literature on causality. See a comprehensive comparison of literature in Appendix  F . ", "page_idx": 9, "bbox": [107, 143.66656494140625, 505, 199.30747985839844], "page_size": [612.0, 792.0]}
{"layout": 79, "type": "text", "text": "7 Discussion of Limitations and Future Work ", "text_level": 1, "page_idx": 9, "bbox": [106, 208, 349, 222], "page_size": [612.0, 792.0]}
{"layout": 80, "type": "text", "text": "A Natural Language  “Mini Turing Test”  for Causality. Pearl and Mackenzie  [ 66 ]  describe an ideal  “mini-Turing test”  to assess understanding of causal inference, and argue that if a machine can answer all possible questions correctly, then it “understands” causality. According to the authors, this is because there are no possible shortcuts when you consider all possible combinations of queries, graphs and data in this ideal test: due to their combinatorial explosion, the machine can only answer all questions right if it correctly applies causal reasoning. From this point of view, our work constitutes a  first step towards a mini-Turing test formulated in natural language . However, we cover only some of the commonly studied causal queries spanning all three rungs. Future work may extend this to further queries, such as, e.g., path-specific effects other than NDE and NIE [ 52 ], thereby increasing the number of potential questions and moving closer to the ideal test. ", "page_idx": 9, "bbox": [107, 226.43603515625, 505, 337.021484375], "page_size": [612.0, 792.0]}
{"layout": 81, "type": "text", "text": "LLMs and Causal Reasoning. It has been claimed that LLMs understand causality well (e.g., [ 45 ] report high performance, such as  $97\\%$   and  $92\\%$  ). In contrast, our work suggests that LLMs may still be far from reasoning reliably about causality (reaching only  $60+\\%$   on CL ADDER ). As argued in Section  1 , we believe that investigating this aspect may be of particular importance, since causal inference is crucial in many policy-relevant scenarios, where reliable AI systems could assist decision- making: from epidemiology [ 22 ,  79 ] to economics [ 10 ,  37 ] to fairness [ 47 ,  71 ]. Testing the abilities of these systems in semi-realistic scenarios is therefore crucial, motivating some of the design choices in our dataset: e.g., the example in Figure  1  was inspired by similar questions which arose in the context of the COVID-19 pandemic, where incorrect causal reasoning resulted in a fallacy where vaccinations were considered to be harmful instead of beneficial [ 20 ,  49 ]. Further work may be dedicated to making the questions and verb aliz at ions even closer to realistic instances of causal inference problems. ", "page_idx": 9, "bbox": [107, 340.669921875, 505, 462.12451171875], "page_size": [612.0, 792.0]}
{"layout": 82, "type": "text", "text": "A CI Engine Plug-in for LLMs. An interesting direction for future research could be to provide the LLM access to an actual implementation of the CI engine. For example, Davis and Aaronson  [ 13 ] tested the improvement of math abilities in LLMs augmented with plug-ins (i.e., external modules that extend the model’s capabilities by adding specific functionality or customizing its behaviour for particular tasks, like a calculator), suggesting that they significantly enhance the model’s ability to solve these problems. However, even with plug-ins, there are still often  “interface”  failures: that is,  “[the LLM] often has trouble formulating problems in a way that elicits useful answers from the plug-ins” . We hypothesis e that something similar would happen for causal inference: even once suitable plug-ins are built, the language-to-tool interface may still be a non-trivial research question. ", "page_idx": 9, "bbox": [107, 465.7729187011719, 505, 565.4094848632812], "page_size": [612.0, 792.0]}
{"layout": 83, "type": "text", "text": "8 Conclusion ", "text_level": 1, "page_idx": 9, "bbox": [106, 574, 186, 587], "page_size": [612.0, 792.0]}
{"layout": 84, "type": "text", "text": "We proposed formal causal reasoning as a new task to evaluate LLMs, and created the CL ADDER benchmark, covering several aspects of causal inference across all rungs of the ladder of causation and verb aliz at ions involving semi-realistic scenarios. To address the task, we proposed a prompting strategy, C AUSAL C O T, inspired by the principles of formal causal inference, which introduces multistep chain-of-thought reasoning for causal questions. Extensive experiments indicate that this dataset is highly challenging, thus offering a principled tool to gain a better understanding of the reasoning abilities of LLMs and to develop better models for causal reasoning in natural language. ", "page_idx": 9, "bbox": [107, 593.9175415039062, 505, 671.3775024414062], "page_size": [612.0, 792.0]}
{"layout": 85, "type": "text", "text": "Acknowledgment ", "text_level": 1, "page_idx": 9, "bbox": [107, 680, 199, 694], "page_size": [612.0, 792.0]}
{"layout": 86, "type": "text", "text": "We thank Sergio Hernan Garrido Mejia for pointing us to Python implementations of the causal inference engine. We thank Armen Aghajanyan for the idea of testing psychological bias in LLMs, which partly contributes to the idea of exposing causal bias in LLMs. We thank András Strausz for various timely coding help, especially for our Simpson’s paradox case. ", "page_idx": 9, "bbox": [107, 699.8855590820312, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 87, "type": "text", "text": "", "page_idx": 10, "bbox": [107, 72.757568359375, 505, 95.67150115966797], "page_size": [612.0, 792.0]}
{"layout": 88, "type": "text", "text": "The material presented in this manuscript is partly based upon works supported by the German Federal Ministry of Education and Research (BMBF): Tübingen AI Center, FKZ: 01IS18039B; by the Machine Learning Cluster of Excellence, EXC number 2064/1 – Project number 390727645; the Swiss National Science Foundation (Project No. 197155); a Responsible AI grant by the Has ler stiftung; an ETH Grant (ETH-19 21-1); and by the John Templeton Foundation (grant #61156). Zhijing Jin is supported by PhD fellowships from the Future of Life Institute and Open Philanthropy, as well as the travel support from ELISE (GA no 951847) for the ELLIS program. Felix Leeb is supported by the International Max Planck Research School for Intelligent Systems (IMPRS-IS). Luigi Gresele is supported by the Video Predict project, FKZ: 01IS21088. ", "page_idx": 10, "bbox": [107, 100.029541015625, 505, 199.30747985839844], "page_size": [612.0, 792.0]}
{"layout": 89, "type": "text", "text": "Author Contributions ", "text_level": 1, "page_idx": 10, "bbox": [107, 209, 221, 222], "page_size": [612.0, 792.0]}
{"layout": 90, "type": "text", "text": "The conceptualization and design of this project was led by Zhijing, Luigi and Felix, and supervised by Mrinmaya on the NLP part, and Bernhard on the causality part. Max provided timely insights from cognitive science on different types of causal tasks and on the project design. In the exploration stage, Ojasv did substantial work on discovering causal fallacies in news and on Twitter, which, while not included in the current systematic way of generating causal inference questions, was a significant contribution in the course of the project and in comparing various task formulations. ", "page_idx": 10, "bbox": [107, 228.22357177734375, 505, 294.7745056152344], "page_size": [612.0, 792.0]}
{"layout": 91, "type": "text", "text": "As for the op e rationalization and programming, the dataset composition was mainly led by Yuen and Felix, together with daily discussions with Zhijing, and weekly discussions with Luigi. Zhiheng supported an important function of generating the backdoor adjustment set for a given causal graph with the treatment and effect variables. The experiments are mainly conducted by Zhijing and Fernando, with Kevin finishing the evaluation results using the ROSCOE package. ", "page_idx": 10, "bbox": [107, 299.132568359375, 505, 354.7745056152344], "page_size": [612.0, 792.0]}
{"layout": 92, "type": "text", "text": "References ", "text_level": 1, "page_idx": 10, "bbox": [107, 364, 165, 376], "page_size": [612.0, 792.0]}
{"layout": 93, "type": "text", "text": "[1]  Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, Nicholas Joseph, Saurav Kadavath, Jackson Kernion, Tom Conerly, Sheer El Showk, Nelson Elhage, Zac Hatfield-Dodds, Danny Hernandez, Tristan Hume, Scott Johnston, Shauna Kravec, Liane Lovitt, Neel Nanda, Catherine Olsson, Dario Amodei, Tom B. Brown, Jack Clark, Sam McCandlish, Chris Olah, Benjamin Mann, and Jared Kaplan. 2022. Training a helpful and harmless assistant with reinforcement learning from human feedback.  CoRR , abs/2204.05862. [Cited on page  8 .] [2]  David Baidoo-Anu and Leticia Owusu Ansah. 2023. Education in the era of generative artificial intelligence (AI): Understanding the potential benefits of ChatGPT in promoting teaching and learning.  Available at SSRN 4337484 . [Cited on page  9 .] [3]  Elias Bareinboim, Juan D Correa, Duligur Ibeling, and Thomas Icard. 2022. On Pearl’s hierarchy and the foundations of causal inference. In  Probabilistic and causal inference: the works of judea pearl , pages 507–556. [Cited on pages  2  and  3 .] [4]  Steven Bethard, William Corvey, Sara K lingen stein, and James H. Martin. 2008. Building a corpus of temporal-causal structure. In  Proceedings of the Sixth International Conference on Language Resources and Evaluation (LREC’08) , Marrakech, Morocco. European Language Resources Association (ELRA). [Cited on page  10 .] [5]  Chandra Bhaga va tula, Ronan Le Bras, Chaitanya Malaviya, Keisuke Sakaguchi, Ari Holtzman, Hannah Rashkin, Doug Downey, Wen-tau Yih, and Yejin Choi. 2020. Abductive commonsense reasoning. In  8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020 . OpenReview.net. [Cited on page  27 .] [6]  Stephan Bongers, Patrick Forré, Jonas Peters, and Joris M Mooij. 2021. Foundations of structural causal models with cycles and latent variables.  The Annals of Statistics , 49(5):2885– 2915. [Cited on page  23 .] [7]  Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neel a kant an, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agar- wal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, ", "page_idx": 10, "bbox": [117, 383.6905517578125, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 94, "type": "text", "text": "Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCan- dlish, Alec Radford, Ilya Sutskever, and Dario Amodei. 2020. Language models are few-shot learners. In  Advances in Neural Information Processing Systems 33: Annual Conference on ", "page_idx": 11, "bbox": [134, 72.757568359375, 505, 117.48949432373047], "page_size": [612.0, 792.0]}
{"layout": 95, "type": "text", "text": "[Cited on pages  1 ,  8 , and  9 .]\n\n [8]  Sébastien Bubeck, Varun Chandra sekar an, Ronen Eldan, Johannes Gehrke, Eric Horvitz, Ece Kamar, Peter Lee, Yin Tat Lee, Yuanzhi Li, Scott M. Lundberg, Harsha Nori, Hamid Palangi, Marco Túlio Ribeiro, and Yi Zhang. 2023. Sparks of artificial general intelligence: Early experiments with GPT-4.  CoRR , abs/2303.12712. [Cited on pages  8  and  9 .]\n\n [9]  Angela Cao, Gregor Williamson, and Jinho D. Choi. 2022. A cognitive approach to annotating causal constructions in a cross-genre corpus. In  Proceedings of the 16th Linguistic Annota- tion Workshop (LAW-XVI) within LREC2022 , pages 151–159, Marseille, France. European Language Resources Association. [Cited on page  10 .]\n\n [10]  David Card. 1999. The causal effect of education on earnings.  Handbook of labor economics , 3:1801–1863. [Cited on pages  1  and  10 .]\n\n [11]  Raj Chetty, John N Friedman, Nathaniel Hilger, Emmanuel Saez, Diane Whitmore Schanzen- bach, and Danny Yagan. 2011. How does your kindergarten classroom affect your earnings? Evidence from project star.  The Quarterly journal of economics , 126(4):1593–1660. [Cited on page  1 .]\n\n [12]  Robert G Cowell, Philip Dawid, Steffen L Lauritzen, and David J Spiegel halter. 2007.  Proba- bilistic networks and expert systems: Exact computational methods for Bayesian networks . Springer Science & Business Media. [Cited on page  3 .]\n\n [13]  Ernest Davis and Scott Aaronson. 2023. Testing GPT-4 with Wolfram Alpha and Code Interpreter plug-ins on math and science problems.  arXiv preprint arXiv:2308.05713 . [Cited on page  10 .]\n\n [14]  Gaston De Serres, France Markowski, Eveline Toth, Monique Landry, Danielle Auger, Marlène Mercier, Philippe Bélanger, Bruno Turmel, Horacio Arruda, Nicole Boulianne, et al. 2013. Largest measles epidemic in North America in a decade—Quebec, Canada, 2011: Contribution of susceptibility, serendipity, and super spreading events.  The Journal of infectious diseases , 207(6):990–998. [Cited on page  1 .]\n\n [15]  Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019. BERT: Pre- training of deep bidirectional transformers for language understanding. In  Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers) , pages 4171– 4186, Minneapolis, Minnesota. Association for Computational Linguistics. [Cited on pages  1 and  9 .]\n\n [16]  Quang Do, Yee Seng Chan, and Dan Roth. 2011. Minimally supervised event causality identification. In  Proceedings of the 2011 Conference on Empirical Methods in Natural Lan- guage Processing , pages 294–303, Edinburgh, Scotland, UK. Association for Computational Linguistics. [Cited on page  27 .]\n\n [17]  Richard Doll and A Bradford Hill. 1950. Smoking and carcinoma of the lung.  British medical journal , 2(4682):739. [Cited on page  1 .]\n\n [18]  Richard Doll and A Bradford Hill. 1954. The mortality of doctors in relation to their smoking habits.  British medical journal , 1(4877):1451. [Cited on page  1 .]\n\n [19]  Jesse Dunietz, Lori Levin, and Jaime Carbonell. 2017. The BECauSE corpus 2.0: Annotating causality and overlapping relations. In  Proceedings of the 11th Linguistic Annotation Workshop , pages 95–104, Valencia, Spain. Association for Computational Linguistics. [Cited on page  27 .]\n\n [20]  Jordan Ellenberg. 2021. Coronavirus vaccines work. But this statistical illusion makes people think they don’t.  The Washington Post . [Cited on page  10 .] ", "page_idx": 11, "bbox": [112, 127.30255126953125, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 96, "type": "text", "text": "[21]  Jörg Frohberg and Frank Binder. 2022. CRASS: A novel data set and benchmark to test counter factual reasoning of large language models. In  Proceedings of the Thirteenth Lan- guage Resources and Evaluation Conference , pages 2126–2140, Marseille, France. European Language Resources Association. [Cited on page  27 .]\n\n [22]  Thomas A Glass, Steven N Goodman, Miguel A Hernán, and Jonathan M Samet. 2013. Causal inference in public health.  Annual review of public health , 34:61–75. [Cited on page  10 .]\n\n [23]  Madelyn Glymour, Judea Pearl, and Nicholas P Jewell. 2016.  Causal inference in statistics: A primer . John Wiley and Sons. [Cited on pages  2  and  19 .]\n\n [24]  Moisés Goldszmidt and Judea Pearl. 1992. Rank-based systems: A simple approach to belief revision, belief update, and reasoning about evidence and actions.  KR , 92:661–672. [Cited on pages  2  and  3 .]\n\n [25]  Olga Golovneva, Moya Chen, Spencer Poff, Martin Corredor, Luke Z ett le moyer, Maryam Fazel-Zarandi, and Asli Cel i kyi l maz. 2022. Roscoe: A suite of metrics for scoring step-by-step reasoning. [Cited on pages  9  and  25 .]\n\n [26]  Andrew Gordon, Zornitsa Kozareva, and Melissa Roemmele. 2012. SemEval-2012 task 7: Choice of plausible alternatives: An evaluation of commonsense causal reasoning. In \\*SEM 2012: The First Joint Conference on Lexical and Computational Semantics – Volume 1: Proceedings of the main conference and the shared task, and Volume 2: Proceedings of the Sixth International Workshop on Semantic Evaluation (SemEval 2012) , pages 394–398, Montréal, Canada. Association for Computational Linguistics. [Cited on page  27 .]\n\n [27]  Joseph Y. Halpern and Judea Pearl. 2005. Causes and explanations: A structural-model approach. part i: Causes.  The British Journal for the Philosophy of Science , 56(4):843–887. [Cited on page  19 .]\n\n [28]  Joseph Y Halpern and Judea Pearl. 2005. Causes and explanations: A structural-model approach. part ii: Explanations.  The British journal for the philosophy of science . [Cited on page  19 .]\n\n [29]  Yuval Noah Harari. 2014.  Sapiens: A brief history of humankind . Random House. [Cited on page  1 .]\n\n [30]  James J Heckman, Lance J Lochner, and Petra E Todd. 2006. Earnings functions, rates of return and treatment effects: The mincer equation and beyond.  Handbook of the Economics of Education , 1:307–458. [Cited on page  1 .]\n\n [31]  Iris Hendrickx, Su Nam Kim, Zornitsa Kozareva, Preslav Nakov, Diarmuid Ó Séaghdha, Sebastian Padó, Marco Penna c chi ott i, Lorenza Romano, and Stan Szpakowicz. 2010. SemEval- 2010 task 8: Multi-way classification of semantic relations between pairs of nominals. In Proceedings of the 5th International Workshop on Semantic Evaluation , pages 33–38, Uppsala, Sweden. Association for Computational Linguistics. [Cited on page  27 .]\n\n [32]  Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt. 2021. Measuring mathematical problem solving with the MATH dataset. In  Proceedings of the Neural Information Processing Systems Track on Datasets and Benchmarks 1, NeurIPS Datasets and Benchmarks 2021, December 2021, virtual . [Cited on pages  4  and  7 .]\n\n [33]  Christopher Hidey and Kathy McKeown. 2016. Identifying causal relations using parallel Wikipedia articles. In  Proceedings of the 54th Annual Meeting of the Association for Computa- tional Linguistics (Volume 1: Long Papers) , pages 1424–1433, Berlin, Germany. Association for Computational Linguistics. [Cited on page  10 .]\n\n [34]  Matthew Ho, Aditya Sharma, Justin Chang, Michael Saxon, Sharon Levy, Yujie Lu, and William Yang Wang. 2022. Wikiwhy: Answering and explaining cause-and-effect questions. arXiv preprint arXiv:2210.12152 . [Cited on page  2 .]\n\n [35]  Mark Hopkins and Judea Pearl. 2007. Causality and counter factual s in the situation calculus. Journal of Logic and Computation , 17(5):939–953. [Cited on page  19 .] ", "page_idx": 12, "bbox": [112, 72.757568359375, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 97, "type": "text", "text": "[36]  Yimin Huang and Marco Valtorta. 2006. Pearl’s calculus of intervention is complete. In Proceedings of the Twenty-Second Conference on Uncertainty in Artificial Intelligence , pages 217–224. [Cited on pages  3  and  4 .]\n\n [37]  Paul Hünermund and Elias Bareinboim. 2019. Causal inference and data fusion in econometrics. CoRR , abs/1912.09104. [Cited on pages  4 ,  5 , and  10 .]\n\n [38]  Ferenc Huszár. 2023. We may be surprised again: Why i take llms seriously. [Cited on page  2 .]\n\n [39]  Oana Ignat, Zhijing Jin, Artem Abzaliev, Laura Biester, Santiago Castro, Naihao Deng, Xinyi Gao, Aylin Gunal, Jacky He, Ashkan Kazemi, Muhammad Khalifa, Namho Koh, Andrew Lee, Siyang Liu, Do June Min, Shinka Mori, Joan Nwatu, Verónica Pérez-Rosas, Siqi Shen, Zekun Wang, Winston Wu, and Rada Mihalcea. 2023. A PhD student’s perspective on research in NLP in the era of very large language models.  CoRR , abs/2305.12544. [Cited on pages  1 and  9 .]\n\n [40]  Zhengbao Jiang, Frank F. Xu, Jun Araki, and Graham Neubig. 2020. How can we know what language models know?  Transactions of the Association for Computational Linguistics , 8:423–438. [Cited on page  2 .]\n\n [41]  Zhijing Jin, Abhinav Lalwani, Tejas Vaidhya, Xiaoyu Shen, Yiwen Ding, Zhiheng Lyu, Mrinmaya Sachan, Rada Mihalcea, and Bernhard Schölkopf. 2022. Logical fallacy detection. In  Findings of the Association for Computational Linguistics: EMNLP 2022 , pages 7180–7198, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics. [Cited on page  9 .]\n\n [42]  Zhijing Jin, Jiarui Liu, Zhiheng Lyu, Spencer Poff, Mrinmaya Sachan, Rada Mihalcea, Mona T. Diab, and Bernhard Schölkopf. 2023. Can large language models infer causation from correlation?  CoRR , abs/2306.05836. [Cited on pages  8 ,  10 , and  27 .]\n\n [43]  Daniel Martin Katz, Michael James Bommarito, Shang Gao, and Pablo Arredondo. 2023. Gpt-4 passes the bar exam.  Available at SSRN 4389233 . [Cited on pages  8  and  9 .]\n\n [44]  Armin Keki´ c, Jonas Dehning, Luigi Gresele, Julius von Kügelgen, Viola Priesemann, and Bernhard Schölkopf. 2023. Evaluating vaccine allocation strategies using simulation-assisted causal modeling.  Patterns . [Cited on page  1 .]\n\n [45]  Emre Kıcıman, Robert Ness, Amit Sharma, and Chenhao Tan. 2023. Causal reasoning and large language models: Opening a new frontier for causality.  arXiv preprint arXiv:2305.00050 . [Cited on pages  9  and  10 .]\n\n [46]  Yash Kumar Lal, Nathanael Chambers, Raymond Mooney, and Niranjan Bala subramania n. 2021. TellMeWhy: A dataset for answering why-questions in narratives. In  Findings of the Association for Computational Linguistics: ACL-IJCNLP 2021 , pages 596–610, Online. Association for Computational Linguistics. [Cited on page  27 .]\n\n [47]  Joshua R Loftus, Chris Russell, Matt J Kusner, and Ricardo Silva. 2018. Causal reasoning for algorithmic fairness.  arXiv preprint arXiv:1805.05859 . [Cited on page  10 .]\n\n [48]  Paramita Mirza, Rachele Sprugnoli, Sara Tonelli, and Manuela Speranza. 2014. Annotating causality in the TempEval-3 corpus. In  Proceedings of the EACL 2014 Workshop on Computa- tional Approaches to Causality in Language (CAtoCL) , pages 10–19, Gothenburg, Sweden. Association for Computational Linguistics. [Cited on page  27 .]\n\n [49]  Jeffrey Morris. 2021. Israeli data: How can efficacy vs. severe disease be strong when  $60\\%$   of hospitalized are vaccinated? Accessed: 27th of October 2023. [Cited on page  10 .]\n\n [50]  Nasrin Most af azad eh, Alyson Grealish, Nathanael Chambers, James Allen, and Lucy Van- derwende. 2016. CaTeRS: Causal and temporal relation scheme for semantic annotation of event structures. In  Proceedings of the Fourth Workshop on Events , pages 51–61, San Diego, California. Association for Computational Linguistics. [Cited on page  27 .]\n\n [51] Daniel Naber et al. 2003. A rule-based style and grammar checker. [Cited on page  7 .] ", "page_idx": 13, "bbox": [112, 72.757568359375, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 98, "type": "text", "text": "[52]  Razieh Nabi and Ilya Shpitser. 2018. Fair inference on outcomes. In  Proceedings of the Thirty-Second AAAI Conference on Artificial Intelligence, (AAAI-18), the 30th innovative Applications of Artificial Intelligence (IAAI-18), and the 8th AAAI Symposium on Educational Advances in Artificial Intelligence (EAAI-18), New Orleans, Louisiana, USA, February 2-7, 2018 , pages 1931–1940. AAAI Press. [Cited on page  10 .]\n\n ", "page_idx": 14, "bbox": [112, 72.757568359375, 505, 128.3984832763672], "page_size": [612.0, 792.0]}
{"layout": 99, "type": "text", "text": "[53] Brady Neal. 2020. Introduction to causal inference. [Cited on page  19 .]\n\n ", "page_idx": 14, "bbox": [112, 137.24053955078125, 420, 149.24546813964844], "page_size": [612.0, 792.0]}
{"layout": 100, "type": "text", "text": "[54]  Harsha Nori, Nicholas King, Scott Mayer McKinney, Dean Carignan, and Eric Horvitz. 2023. Capabilities of GPT-4 on medical challenge problems.  CoRR , abs/2303.13375. [Cited on pages  8  and  9 .]\n\n ", "page_idx": 14, "bbox": [112, 158.0875244140625, 505, 191.91050720214844], "page_size": [612.0, 792.0]}
{"layout": 101, "type": "text", "text": "[55]  Maxwell I. Nye, Anders Johan Andreassen, Guy Gur-Ari, Henryk Micha lewski, Jacob Austin, David Bieber, David Dohan, Aitor Lewkowycz, Maarten Bosma, David Luan, Charles Sutton, ", "page_idx": 14, "bbox": [112, 200.7535400390625, 505, 223.66746520996094], "page_size": [612.0, 792.0]}
{"layout": 102, "type": "text", "text": "language models.  CoRR , abs/2112.00114. [Cited on page  7 .]\n\n [56]  OpenAI. 2023. GPT-4 technical report.  CoRR , abs/2303.08774. [Cited on pages  1 ,  8 , and  9 .]\n\n [57]  Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul F. Christiano, Jan Leike, and Ryan Lowe. 2022. Training language models to follow instructions with human feedback.  CoRR , abs/2203.02155. [Cited on page  8 .]\n\n [58]  Judea Pearl. 1988.  Probabilistic reasoning in intelligent systems: Networks of plausible inference . Morgan Kaufmann. [Cited on page  3 .]\n\n [59]  Judea Pearl. 1995. Causal diagrams for empirical research.  Biometrika , 82(4):669–688. [Cited on pages  2 ,  3 ,  4 ,  5 , and  24 .]\n\n [60]  Judea Pearl. 2009. Causal inference in statistics: An overview.  Statistics Surveys , 3(none):96 – 146. [Cited on page  19 .]\n\n [61]  Judea Pearl. 2009. Causality: Models, reasoning and inference (2nd ed.) . Cambridge University Press. [Cited on pages  2  and  23 .]\n\n [62]  Judea Pearl. 2011. The algorithm iz ation of counter factual s.  Annals of Mathematics and Artificial Intelligence , 61:29–39. [Cited on page  3 .]\n\n [63] Judea Pearl. 2022. Comment: understanding simpson’s paradox. In  Probabilistic and causal inference: The works of judea Pearl , pages 399–412. [Cited on page  2 .]\n\n [64]  Judea Pearl and Elias Bareinboim. 2022. External validity: From do-calculus to transport ability across populations. In  Probabilistic and causal inference: The works of Judea Pearl , pages 451–482. [Cited on page  3 .]\n\n [65]  Judea Pearl, Madelyn Glymour, and Nicholas P Jewell. 2016.  Causal inference in statistics: A primer . John Wiley & Sons. [Cited on page  3 .]\n\n [66]  Judea Pearl and Dana Mackenzie. 2018.  The book of why: The new science of cause and effect . Basic books. [Cited on pages  1 ,  2 ,  3 ,  4 ,  5 ,  7 ,  10 , and  19 .]\n\n [67]  Judea Pearl et al. 2000.  Causality: Models, reasoning and inference . Cambridge University Press. [Cited on pages  3 ,  5 ,  19 , and  24 .]\n\n [68]  Derek C Penn and Daniel J Povinelli. 2007. Causal cognition in human and nonhuman animals: A comparative, critical review.  Annu. Rev. Psychol. , 58:97–118. [Cited on page  1 .]\n\n [69]  Jonas Peters, Dominik Janzing, and Bernhard Schölkopf. 2017.  Elements of causal inference: Foundations and learning algorithms . The MIT Press. [Cited on pages  2 ,  5 , and  19 .] ", "page_idx": 14, "bbox": [112, 233.48052978515625, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 103, "type": "text", "text": "[70]  Fabio Petroni, Tim Rock t s chel, Sebastian Riedel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, and Alexander Miller. 2019. Language models as knowledge bases? In  Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP) , pages 2463–2473, Hong Kong, China. Association for Computational Linguistics. [Cited on page  2 .]\n\n [71]  Drago Plecko and Elias Bareinboim. 2022. Causal fairness analysis. arXiv preprint arXiv:2207.11385 . [Cited on page  10 .]\n\n [72]  Stanley A Plotkin. 2005. Vaccines: Past, present and future.  Nature medicine , 11(Suppl 4):S5–S11. [Cited on page  1 .]\n\n [73]  George P sachar o poul os and Harry Anthony Patrinos. 2004. Returns to investment in education: A further update.  Education economics , 12(2):111–134. [Cited on page  1 .]\n\n [74]  Chengwei Qin, Aston Zhang, Zhuosheng Zhang, Jiaao Chen, Michihiro Yasunaga, and Diyi Yang. 2023. Is chatgpt a general-purpose natural language processing task solver?  CoRR , abs/2302.06476. [Cited on page  9 .]\n\n [75]  Lianhui Qin, Antoine Bosselut, Ari Holtzman, Chandra Bhaga va tula, Elizabeth Clark, and Yejin Choi. 2019. Counter factual story reasoning and generation. In  Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP) , pages 5043–5053, Hong Kong, China. Association for Computational Linguistics. [Cited on pages  9  and  27 .]\n\n [76]  Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever. 2019. Language models are unsupervised multitask learners.  OpenAI Blog , 1(8). [Cited on pages  1 , 8 , and  9 .]\n\n [77]  Hannah Rashkin, Maarten Sap, Emily Allaway, Noah A. Smith, and Yejin Choi. 2018. Event2Mind: Commonsense inference on events, intents, and reactions. In  Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers) , pages 463–473, Melbourne, Australia. Association for Computational Linguistics. [Cited on page  27 .]\n\n [78]  Yasaman Razeghi, Robert L Logan IV, Matt Gardner, and Sameer Singh. 2022. Impact of pre training term frequencies on few-shot numerical reasoning. In  Findings of the Association for Computational Linguistics: EMNLP 2022 , pages 840–854, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics. [Cited on page  8 .]\n\n [79]  Kenneth J Rothman and Sander Greenland. 2005. Causation and causal inference in epidemi- ology.  American journal of public health , 95(S1):S144–S150. [Cited on page  10 .]\n\n [80]  Jürgen Rudolph, Samson Tan, and Shannon Tan. 2023. Chatgpt: Bullshit spewer or the end of traditional assessments in higher education?  Journal of Applied Learning and Teaching , 6(1). [Cited on page  9 .]\n\n [81]  Maarten Sap, Ronan Le Bras, Emily Allaway, Chandra Bhaga va tula, Nicholas Lourie, Hannah Rashkin, Brendan Roof, Noah A. Smith, and Yejin Choi. 2019. ATOMIC: an atlas of machine commonsense for if-then reasoning. In  The Thirty-Third AAAI Conference on Artificial Intelligence, AAAI 2019, The Thirty-First Innovative Applications of Artificial Intelligence Conference, IAAI 2019, The Ninth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2019, Honolulu, Hawaii, USA, January 27 - February 1, 2019 , pages 3027–3035. AAAI Press. [Cited on pages  9  and  27 .]\n\n [82]  Maarten Sap, Hannah Rashkin, Derek Chen, Ronan Le Bras, and Yejin Choi. 2019. Social iqa: Commonsense reasoning about social interactions. In  EMNLP 2019 . [Cited on pages  9 and  27 .]\n\n [83]  Taylor Shin, Yasaman Razeghi, Robert L. Logan IV, Eric Wallace, and Sameer Singh. 2020. AutoPrompt: Eliciting Knowledge from Language Models with Automatically Generated Prompts. In  Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP) , pages 4222–4235, Online. Association for Computational Linguistics. [Cited on page  2 .] ", "page_idx": 15, "bbox": [112, 72.757568359375, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 104, "type": "text", "text": "[84]  Ilya Shpitser and Judea Pearl. 2006. Identification of conditional interventional distributions. In  22nd Conference on Uncertainty in Artificial Intelligence, UAI 2006 , pages 437–444. [Cited on pages  3  and  4 .]\n\n ", "page_idx": 16, "bbox": [112, 72.757568359375, 505, 106.58049774169922], "page_size": [612.0, 792.0]}
{"layout": 105, "type": "text", "text": "[85]  Ilya Shpitser and Judea Pearl. 2006. Identification of joint interventional distributions in recur- sive semi-markovian causal models. In  Proceedings, The Twenty-First National Conference on Artificial Intelligence and the Eighteenth Innovative Applications of Artificial Intelligence Conference, July 16-20, 2006, Boston, Massachusetts, USA , pages 1219–1226. AAAI Press. [Cited on page  24 .]\n\n ", "page_idx": 16, "bbox": [112, 113.65155029296875, 505, 169.2935028076172], "page_size": [612.0, 792.0]}
{"layout": 106, "type": "text", "text": "[86]  Shikhar Singh, Nuan Wen, Yu Hou, Pegah Ali poor mola bash i, Te-lin Wu, Xuezhe Ma, and Nanyun Peng. 2021. COM2SENSE: A commonsense reasoning benchmark with complemen- tary sentences. In  Findings of the Association for Computational Linguistics: ACL-IJCNLP\n\n ", "page_idx": 16, "bbox": [112, 176.36456298828125, 505, 210.18748474121094], "page_size": [612.0, 792.0]}
{"layout": 107, "type": "text", "text": "[87]  Karan Singhal, Shekoofeh Azizi, Tao Tu, S. Sara Mahdavi, Jason Wei, Hyung Won Chung, Nathan Scales, Ajay Kumar Tanwani, Heather Cole-Lewis, Stephen Pfohl, Perry Payne, Martin Sen evi rat ne, Paul Gamble, Chris Kelly, Nathaneal Schärli, Aakanksha Chowdhery, Philip Andrew Mansfield, Blaise Agüera y Arcas, Dale R. Webster, Gregory S. Corrado, Yossi Matias, Katherine Chou, Juraj Gottweis, Nenad Tomasev, Yun Liu, Alvin Rajkomar, Joelle K. Barral, Christopher Semturs, Alan Kart hikes a lingam, and Vivek Natarajan. 2022. Large language models encode clinical knowledge.  CoRR , abs/2212.13138. [Cited on page  9 .]\n\n [88]  Peter Spirtes, Clark Glymour, and Richard Scheines. 2000.  Causation, Prediction, and Search, Second Edition . Adaptive computation and machine learning. MIT Press. [Cited on pages  2 and  5 .]\n\n [89]  Aarohi Srivastava, Abhinav Rastogi, Abhishek Rao, Abu Awal Md Shoeb, Abubakar Abid, Adam Fisch, Adam R. Brown, Adam Santoro, Aditya Gupta, Adrià Garriga-Alonso, Ag- nieszka Kluska, Aitor Lewkowycz, Akshat Agarwal, Alethea Power, Alex Ray, Alex Warstadt, Alexander W. Kocurek, Ali Safaya, Ali Tazarv, Alice Xiang, Alicia Parrish, Allen Nie, Aman Hussain, Amanda Askell, Amanda Dsouza, Ameet Rahane, Anantha raman S. Iyer, Anders Andreassen, Andrea Santilli, Andreas Stu hl m ller, Andrew M. Dai, Andrew La, Andrew K. Lampinen, Andy Zou, Angela Jiang, Angelica Chen, Anh Vuong, Animesh Gupta, Anna Gottardi, Antonio Norelli, Anu Venkatesh, Arash Ghola mid a vo odi, Arfa Tabassum, Arul Menezes, Arun Ki rub a rajan, Asher Mull ok and ov, Ashish Sabharwal, Austin Herrick, Avia Efrat, Aykut Erdem, Ayla Karakas, and et al. 2022. Beyond the imitation game: Quantifying and extrapolating the capabilities of language models.  CoRR , abs/2206.04615. [Cited on page  9 .]\n\n [90]  Manfred Stede. 2008. Connective-based local coherence analysis: A lexicon for recognizing causal relationships. In  Semantics in Text Processing. STEP 2008 Conference Proceedings , pages 221–237. College Publications. [Cited on page  10 .]\n\n [91]  Alessandro Stolfo, Zhijing Jin, Kumar Shridhar, Bernhard Schölkopf, and Mrinmaya Sachan. 2023. A causal framework to quantify the robustness of mathematical reasoning with language models. In  Proceedings of the 61st Annual Meeting of the Association for Computational Lin- guistics (Volume 1: Long Papers) , Toronto, Canada. Association for Computational Linguistics. [Cited on pages  4  and  8 .]\n\n [92]  Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023. Stanford alpaca: An instruction-following llama model.  https://github.com/tatsu-lab/stanford alpaca . [Cited on page  8 .]\n\n [93]  Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timo- thée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, Aurélien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample. 2023. Llama: Open and efficient foundation language models.  CoRR , abs/2302.13971. [Cited on page  8 .]\n\n [94]  Alex Wang, Yada Pr uk s a chat kun, Nikita Nangia, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel R. Bowman. 2019. Superglue: A stickier benchmark for general- Systems 32: Annual Conference on Neural Information Processing Systems 2019, NeurIPS 2019, December 8-14, 2019, Vancouver, BC, Canada , pages 3261–3275. [Cited on page  9 .]\n\n ", "page_idx": 16, "bbox": [112, 228.1685791015625, 505, 711.8905029296875], "page_size": [612.0, 792.0]}
{"layout": 108, "type": "text", "text": "", "page_idx": 17, "bbox": [133, 72.757568359375, 505, 95.67150115966797], "page_size": [612.0, 792.0]}
{"layout": 109, "type": "text", "text": "[95]  Yizhong Wang, Swaroop Mishra, Pegah Ali poor mola bash i, Yeganeh Kordi, Amirreza Mirzaei, Atharva Naik, Arjun Ashok, Arut Selvan Dhana sekar an, Anjana Arunkumar, David Stap, Eshaan Pathak, Giannis Karam a no lak is, Haizhi Gary Lai, Ishan Purohit, Ishani Mondal, Jacob Anderson, Kirby Kuznia, Krima Doshi, Kuntal Kumar Pal, Maitreya Patel, Mehrad Moradshahi, Mihir Parmar, Mirali Purohit, Neeraj Varshney, Phani Rohitha Kaza, Pulkit Verma, Ravsehaj Singh Puri, Rushang Karia, Savan Doshi, Shailaja Keyur Sampat, Siddhartha Mishra, Sujan Reddy A, Sumanta Patro, Tanay Dixit, and Xudong Shen. 2022. Super- natural instructions: Generalization via declarative instructions on   $1600+$   NLP tasks. In Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, EMNLP 2022, Abu Dhabi, United Arab Emirates, December 7-11, 2022 , pages 5085–5109. Association for Computational Linguistics. [Cited on page  9 .]\n\n [96]  Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia, Ed H. Chi, Quoc V. Le, and Denny Zhou. 2022. Chain of thought prompting elicits reasoning in large language models. In  Advances in Neural Information Processing Systems . [Cited on pages  2 and  7 .]\n\n [97]  Cynthia G Whitney, Fangjun Zhou, James Singleton, and Anne Schuchat. 2014. Benefits from immunization during the vaccines for children program era—united states, 1994–2013. Morbidity and Mortality Weekly Report , 63(16):352. [Cited on page  1 .]\n\n [98]  Jinghang Xu, Wanli Zuo, Shining Liang, and Xianglin Zuo. 2020. A review of dataset and labeling methods for causality extraction. In  Proceedings of the 28th International Conference on Computational Linguistics , pages 1519–1531, Barcelona, Spain (Online). International Committee on Computational Linguistics. [Cited on page  10 .]\n\n [99]  Bei Yu, Yingya Li, and Jun Wang. 2019. Detecting causal language use in science find- ings. In  Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP) , pages 4664–4674, Hong Kong, China. Association for Computational Linguistics. [Cited on page  10 .]\n\n [100]  Matej Zeˇ cevi´ c, Moritz Willig, Devendra Singh Dhami, and Kristian Kersting. 2023. Causal parrots: Large language models may talk causality but are not causal.  Transactions on Machine Learning Research . [Cited on pages  2  and  9 .]\n\n [101] Cheng Zhang, Stefan Bauer, Paul Bennett, Jiangfeng Gao, Wenbo Gong, Agrin Hilmkil, Joel Jennings, Chao Ma, Tom Minka, Nick Pawlowski, et al. 2023. Understanding causality with large language models: Feasibility and opportunities.  arXiv preprint arXiv:2304.05524 . [Cited on pages  2  and  9 .]\n\n [102]  Li Zhang, Qing Lyu, and Chris Callison-Burch. 2020. Reasoning about goals, steps, and temporal ordering with WikiHow. In  Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP) , pages 4630–4639, Online. Association for Computational Linguistics. [Cited on pages  9  and  27 .]\n\n [103]  Susan Zhang, Stephen Roller, Naman Goyal, Mikel Artetxe, Moya Chen, Shuohui Chen, Christopher Dewan, Mona T. Diab, Xian Li, Xi Victoria Lin, Todor Mihaylov, Myle Ott, Sam Shleifer, Kurt Shuster, Daniel Simig, Punit Singh Koura, Anjali Sridhar, Tianlu Wang, and Luke Z ett le moyer. 2022. OPT: open pre-trained transformer language models.  CoRR , abs/2205.01068. [Cited on pages  1  and  9 .]\n\n [104]  Daniel M. Ziegler, Nisan Stiennon, Jeffrey Wu, Tom B. Brown, Alec Radford, Dario Amodei, Paul F. Christiano, and Geoffrey Irving. 2019. Fine-tuning language models from human preferences.  CoRR , abs/1909.08593. [Cited on page  8 .]\n\n [105]  Caleb Ziems, William Held, Omar Shaikh, Jiaao Chen, Zhehao Zhang, and Diyi Yang. 2023. Can large language models transform computational social science? [Cited on pages  8  and  9 .] ", "page_idx": 17, "bbox": [107, 102.5455322265625, 505, 706.978515625], "page_size": [612.0, 792.0]}
{"layout": 110, "type": "text", "text": "A Supplementary for Dataset Generation ", "text_level": 1, "page_idx": 18, "bbox": [107, 71, 328, 85], "page_size": [612.0, 792.0]}
{"layout": 111, "type": "text", "text": "A.1 List of References for Causal Inference ", "text_level": 1, "page_idx": 18, "bbox": [108, 94, 299, 106], "page_size": [612.0, 792.0]}
{"layout": 112, "type": "text", "text": "When collecting the causal graphs, query types, and common sens ical stories for our dataset, we took our examples from the following books (sorted by year): ", "page_idx": 18, "bbox": [107, 109.59857177734375, 504, 132.5124969482422], "page_size": [612.0, 792.0]}
{"layout": 113, "type": "text", "text": "1. Causality [ 67 ] 2. Causal inference in statistics: A Primer [ 23 ] 3. Elements of Causal Inference [ 69 ] 4. The Book of Why [ 66 ] 5. Introduction to Causal Inference [ 53 ] ", "page_idx": 18, "bbox": [131, 142.35357666015625, 319.3365478515625, 203.97251892089844], "page_size": [612.0, 792.0]}
{"layout": 114, "type": "text", "text": "And the following papers: ", "page_idx": 18, "bbox": [107, 213.81256103515625, 211.71031188964844, 225.81748962402344], "page_size": [612.0, 792.0]}
{"layout": 115, "type": "text", "text": "1. Causes and Explanations: A Structural-Model Approach. Part I: Causes [ 27 ] 2. Causes and Explanations: A Structural-Model Approach. Part II: Explanations [ 28 ] 3. Causality and Counter factual s in the Situation Calculus [ 35 ] 4. Causal inference in statistics: An overview [ 60 ] ", "page_idx": 18, "bbox": [131, 235.65753173828125, 476.3967590332031, 284.87347412109375], "page_size": [612.0, 792.0]}
{"layout": 116, "type": "image", "page_idx": 18, "img_path": "layout_images/2312.04350v3_8.jpg", "bbox": [202, 298, 407, 588], "page_size": [612.0, 792.0], "ocr_text": "Causal Graph\n\nTreatment-\n\nAlias CGTE Alias Effect Pair\nConfounding Confounding Sox dy\nMediation S039\nImmorality Fork oo\nCollision $30\nDiamond Diamond aoe\nDiamondCut oso\nChain Chain 20>”)\nVv v Gx ty\nZ\nArrowhead Arrowhead a\nFrontdoor Frontdoor 6% O40\n", "vlm_text": "The image is a table comparing different causal graph structures with their aliases and treatment-effect pairs. It includes the following:\n\n1. **Confounding**\n   - CGTE Alias: Confounding, Mediation\n   - Treatment-Effect Pair: Two graphs showing different causal paths between variables X and Y.\n\n2. **Immorality**\n   - CGTE Alias: Fork, Collision\n   - Treatment-Effect Pair: Two graphs showing different formations with variable X at a junction affecting Y and another variable.\n\n3. **Diamond**\n   - CGTE Alias: Diamond, DiamondCut\n   - Treatment-Effect Pair: Two graphs shaped like diamonds or split paths with variables X and Y connected through intermediaries.\n\n4. **Chain**\n   - CGTE Alias: Chain\n   - Treatment-Effect Pair: A linear path from variable X to Y through another variable.\n\n5. **IV**\n   - CGTE Alias: IV\n   - Treatment-Effect Pair: An instrumental variable Z affects X and Y.\n\n6. **Arrowhead**\n   - CGTE Alias: Arrowhead\n   - Treatment-Effect Pair: A branching graph with variable X affecting Y and another intermediary variable.\n\n7. **Frontdoor**\n   - CGTE Alias: Frontdoor\n   - Treatment-Effect Pair: A graph showing both direct and indirect paths from X to Y through Z.\n\nEach section provides a visual representation of the causal relationships among variables, highlighting different structural forms."}
{"layout": 117, "type": "text", "text": "Figure 6: List of all ten causal graphs with treatment-effect pairs (CGTEs). We omit CGTEs that trivially resemble existing ones. ", "page_idx": 18, "bbox": [107, 596.31201171875, 504, 617.0795288085938], "page_size": [612.0, 792.0]}
{"layout": 118, "type": "text", "text": "A.2 Formulation of the Query Types ", "text_level": 1, "page_idx": 18, "bbox": [107, 632, 270, 644], "page_size": [612.0, 792.0]}
{"layout": 119, "type": "text", "text": "Here, we introduce all the query types included in our dataset. ", "page_idx": 18, "bbox": [107, 647.810546875, 355.35137939453125, 659.8154907226562], "page_size": [612.0, 792.0]}
{"layout": 120, "type": "text", "text": "Rung-1 Queries: Marginal and Conditional Probabilities. For marginal probabilities, we ask questions about the overall distribution of a variable. For conditional probabilities, we ask whether conditioning on one variable increases or decreases the likelihood of another variable. For the explaining away questions, we condition on a collider node and ask how that affects the correlation between the two parents. ", "page_idx": 18, "bbox": [107, 666.7999267578125, 504, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 121, "type": "text", "text": "Rung-2 Queries: ATE and Adjustment Set. For ATE questions, we ask whether the treatment  $X=1)$  ) increases or decreases the likelihood of the effect variable  $Y\\,=\\,y$  . For adjustment set questions, we ask whether a set of variables should be adjusted for when estimating the causal effect between treatment and effect. By adjusting, we aim to blocked the non-causal paths from the treatments to effect, and hence eliminate spurious correlation. For example, to query whether the set gender is an adjustment set for the effect of a treatment on recovery, we ask    $^{\\prime\\prime}T o$   estimate the effect of the treatment on recovery, should we directly look at how the treatment correlates with recovery, or should we look at gender-specific correlation?\"  In the collider bias questions, similarly to the explaining away questions, we condition on a collider variable and ask about how an intervention on one of the parents (treatment    $X$  ) affects the other parent (outcome    $Y$  ). However since by construction  $X$   and  $Y$   do not have common causes, the answer to this question is always “no”. ", "page_idx": 19, "bbox": [106, 72.39891815185547, 505, 193.85350036621094], "page_size": [612.0, 792.0]}
{"layout": 122, "type": "text", "text": "Rung-3 Queries: Counter factual Probability, ATT, NDE, and NIE. For counter factual probabil- ity, we ask about what would have been the likelihood of    $Y=y$  , if the treatment variable  $X$   had been  $x$  , given sufficient evidence  $e$   such that the query is identifiable. For ATT, we ask how the likelihood of    $Y=y$   would change for those who received treatment   $X=1$  ) if there had been no treatment (  $X=0$  ). For NDE, we ask whether the    $X=1$   directly increases or decreases the likelihood of the  $Y=y$  , not through any mediators. For NIE, we ask whether the treatment (setting    $X=1$  ) increases or decreases the likelihood of  $Y=y$   through mediators, not directly. ", "page_idx": 19, "bbox": [106, 201.88890075683594, 505, 279.70751953125], "page_size": [612.0, 792.0]}
{"layout": 123, "type": "text", "text": "A.3 Collection of Causal Graphs ", "text_level": 1, "page_idx": 19, "bbox": [107, 292, 254, 302], "page_size": [612.0, 792.0]}
{"layout": 124, "type": "text", "text": "We include all the ten causal graphs with treatment-effect pairs (CGTEs) in Figure  6 . ", "page_idx": 19, "bbox": [106, 306.5765686035156, 446.2503967285156, 318.5815124511719], "page_size": [612.0, 792.0]}
{"layout": 125, "type": "text", "text": "Note that one causal graph can have several different CGTEs, such as the confounding structure, which has three CGTEs: confounding, mediation, and collision in the triangle form. To generate all the causal graphs and CGTEs here, we iterate all commonly used ones within four nodes in the CI books, and omit CGTEs whose solution by CI methods trivially resembles existing ones. ", "page_idx": 19, "bbox": [106, 326.3685607910156, 505, 371.1004943847656], "page_size": [612.0, 792.0]}
{"layout": 126, "type": "text", "text": "A.4 Data Coverage ", "text_level": 1, "page_idx": 19, "bbox": [108, 382, 197, 392], "page_size": [612.0, 792.0]}
{"layout": 127, "type": "text", "text": "Starting from the full set of 12 distinct causal graphs and 10 query types, there are a few combinations that must be omitted as the ground truth answer would be trivial or ill-defined. For example, in the “Immorality” graph, the treatment “X” and outcome “Y” are by construction statistically independent, so there correlation is necessarily 0. Similarly, there are several graphs where certain causal queries are ill-defined or don’t make sense to ask. Specifically: ", "page_idx": 19, "bbox": [106, 397.96954345703125, 505, 453.6105041503906], "page_size": [612.0, 792.0]}
{"layout": 128, "type": "text", "text": "1.  For the Natural Direct Effect, we only include questions on the “IV”, “Arrowhead”, “Con- founding”, “Mediation” and “DiamondCut” graphs. 2.  For the Natural Indirect Effect, we only include questions on the “Mediation”, “Frontdoor”, “Arrowhead”, “Diamond” and “Chain” graphs. 3.  For the Collider Bias and Explaining Away effect, we only include questions on the “Colli- sion” graph. 4. For the Average Treatment Effect, we include questions on all graphs except “Collision”. 5.  For the (deterministic) Counter factual s, we include questions on all graphs except “Colli- sion”. 6.  For the Average Treatment Effect on the Treated (ATT), we include questions on all graphs except “Collision” and “IV”. ", "page_idx": 19, "bbox": [131, 464.3865661621094, 505, 592.9545288085938], "page_size": [612.0, 792.0]}
{"layout": 129, "type": "text", "text": "The “balanced” benchmark (main benchmark in v1.5), containing 10,112 questions split between all stories, graphs, query types, and common sens ical ness, is balanced such that there are roughly the same number of questions for each distinct story-graph-query combination (ranging from 50-100 per combination) across the different variants: commonsense, anti commonsense, and nonsense. Furthermore, we balance the distribution of correct answers so that there are the same number of “yes”s and “no”s. ", "page_idx": 19, "bbox": [106, 603.7295532226562, 505, 670.280517578125], "page_size": [612.0, 792.0]}
{"layout": 130, "type": "text", "text": "The “aggregate” variant (main benchmark in v1.0) contains 10,560 questions and is primarily balanced across all stories. However since the number of stories for each variant (commonsense, anti commonsense, and nonsense) varies significantly, the results in an unbalanced benchmark in terms of sens ical ness. ", "page_idx": 19, "bbox": [106, 678.0675659179688, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 131, "type": "text", "text": "A.5 Query Form and Text Templates ", "text_level": 1, "page_idx": 20, "bbox": [106, 74, 272, 84], "page_size": [612.0, 792.0]}
{"layout": 132, "type": "table", "page_idx": 20, "img_path": "layout_images/2312.04350v3_9.jpg", "table_caption": "We provide in Table  4  the text templates we use for each query type. ", "table_footnote": "Table 4: Example natural language templates for each query type. ", "bbox": [106, 88, 502, 359], "page_size": [612.0, 792.0], "ocr_text": "Natural Language Question Template\n\nIs the overall likelihood of {vnoun(X = 1)} greater than\nchance?\n\nIs the chance of {vnoun(Y = 1)} larger when observing\n{vnoun(X = 1)}?\n\nQuery Type Symbolic Expres-\nsion\n\nRung 1: Association\n\nMarg. Prob. P(Y)\n\nCond. Prob. P(Y |X)\n\nRung 2: Intervention\n\nATE E[Y |do(X = 1)]—\nE[Y |do(X = 0)]\n\nAdjust. Set If S opens a back-\ndoor path\n\nWill {vnoun(X = 1)} increase the chance of {vpoun(Y = 1)}?\n\nTo understand how {voverat(X)} affects {voveran(Y = 1)},\nshould we look directly at how {voverati(X )} correlates with\n{Voveraii(Y )} in general, or this correlation case by case accord-\ning to {Voveran(S)}?\n\nRung 3: Counterfactuals\nCounterf. Prob. P(Yz = y)\n\nATT EY — YolX = 1]\nNDE E[Yi,mo — Y1,mo]\nNIE E[Yo,a1, — Yo,mo]\n\nCan we infer that {usent(Y = 1)} had it been that {ucona(X =\n1)} instead of X=0?\n\nFor {vattr(X = 1)}, would it be more likely to see {Unoun(Y =\n1)} Lvcona(X = 0)#?\n\nIf we disregard the mediation effect through {voverau(Y = 1)},\nwould {Vnoun(X = 1)} still positively affect {unoun(Y = 1)}?\nDoes = {vovera(X)} affect = {Voveran(Y)} through\n{Voverai (Other Vars)}?\n", "vlm_text": "The table provides an overview of different query types, their symbolic expressions, and corresponding natural language question templates across three rungs of causal reasoning: Association, Intervention, and Counterfactuals.\n\n1. **Rung 1: Association**\n   - **Query Type:** \n     - Marginal Probability\n     - Conditional Probability\n   - **Symbolic Expression:** \n     - \\( P(Y) \\)\n     - \\( P(Y|X) \\)\n   - **Natural Language Question Template:** \n     - \"Is the overall likelihood of \\({v_\\text{noun}(X = 1)}\\) greater than chance?\"\n     - \"Is the chance of \\({v_\\text{noun}(Y = 1)}\\) larger when observing \\({v_\\text{noun}(X = 1)}\\)?\"\n\n2. **Rung 2: Intervention**\n   - **Query Type:** \n     - Average Treatment Effect (ATE)\n     - Adjustment Set\n   - **Symbolic Expression:** \n     - \\( \\mathbb{E}[Y|do(X = 1)] - \\mathbb{E}[Y|do(X = 0)] \\)\n     - If \\( S \\) opens a back-door path\n   - **Natural Language Question Template:** \n     - \"Will \\({v_\\text{noun}(X = 1)}\\) increase the chance of \\({v_\\text{noun}(Y = 1)}\\)?\"\n     - \"To understand how \\({v_\\text{overall}(X)}\\) affects \\({v_\\text{overall}(Y = 1)}\\), should we look directly at how \\({v_\\text{overall}(X)}\\) correlates with \\({v_\\text{overall}(Y)}\\) in general, or this correlation case by case according to \\({v_\\text{overall}(S)}\\)?\"\n\n3. **Rung 3: Counterfactuals**\n   - **Query Type:** \n     - Counterfactual Probability\n     - Average Treatment Effect on the Treated (ATT)\n     - Natural Direct Effect (NDE)\n     - Natural Indirect Effect (NIE)\n   - **Symbolic Expression:** \n     - \\( P(Y_x = y) \\)\n     - \\( \\mathbb{E}[Y_1 - Y_0|X = 1] \\)\n     - \\( \\mathbb{E}[Y_{1, M_0} - Y_{1, M_0}] \\)\n     - \\( \\mathbb{E}[Y_{0, M_1} - Y_{0, M_0}] \\)\n   - **Natural Language Question Template:**\n     - \"Can we infer that \\({v_\\text{sent}(Y = 1)}\\) had it been that \\({v_\\text{cond}(X = 1)}\\)"}
{"layout": 133, "type": "text", "text": "A.6 Nonsensical Stories ", "text_level": 1, "page_idx": 20, "bbox": [107, 384, 216, 395], "page_size": [612.0, 792.0]}
{"layout": 134, "type": "text", "text": "To come up with a collection of nonsensical variable names, we use GPT-4 to generate some meaningless words. Specifically, we use the prompt: “Create 100 non-existent words that are short, i.e., within 5-characters.”, with temperature  $\\mathord{:=}0$   with the OpenAI interface. The collection of nonsensical words we later use as variable names are as follows: ziblo, truq, fyze, glimx, jorv, wexi, snov, yupt, kraz, qixy, vubr, chiz, pliv, moxa, fygo, rukz, tasp, xevo, jyke, wibl, zorf, quzy, nyrp, gwex, smez, vytz, hupx, cwoj, lirf, ovka, pexu, yigz, twaz, kwox, zuph, fraq, jyxo, swoy, uvzi, nekl, gyzp, rixq, vwem, xyfu, blyz, qwip, zeku, tijv, yomx, hwaz, czix, plof, muvy, fyqo, rujz, tasb, xevi, jyka, wibm, zorx, quzw, nyro, gwet, smeu, vyta, hupz, cwoi, lirg, ovki, pexy, yigw, twac, kwoz, zupj, fraq, jyxi, swoq, uvzo, nekm, gyzl, rixw, vwen, xyfo, blyx, qwiu, zeky, tijw, yomz, hwax, czir, ploz, muvq, fyqi, rujx, tasn, xevu, jyko, wibp, zory, and quzt. ", "page_idx": 20, "bbox": [107, 398.53955078125, 505, 508.72650146484375], "page_size": [612.0, 792.0]}
{"layout": 135, "type": "text", "text": "A.7 Anti-Common sens ical Stories ", "text_level": 1, "page_idx": 20, "bbox": [107, 515, 260, 527], "page_size": [612.0, 792.0]}
{"layout": 136, "type": "text", "text": "For the anti-common sens ical stories, we randomly do one of the actions: ", "page_idx": 20, "bbox": [107, 529.74853515625, 397.56298828125, 541.7534790039062], "page_size": [612.0, 792.0]}
{"layout": 137, "type": "text", "text": "1.  Replace the effect variable  $Y$   with an attribute that would not be an effect variable in any of the stories. Such replacement variables include: “lip thickness”, “earthquakes”, “lactose intolerance”, “rainfall”, “is allergic to peanuts”, “brown eyes”, “curly hair”, “black hair”, “foot size”, “freckles” 2.  Create an irrelevant treatment variable    $X$   that does not play a causal role in any of our common sens ical stories. Such as: “can swim”, “is religious”, “has a brother”, “has visited England”, “likes spicy food”, “is vegetarian”, “speaks english”, “drinks coffee”, “plays card games”, “listens to jazz”, “solar eclipse”, “has a sister”, “full moon” ", "page_idx": 20, "bbox": [131, 549.1005859375, 505, 638.9635009765625], "page_size": [612.0, 792.0]}
{"layout": 138, "type": "text", "text": "To transform a common sens ical story into an anti-common sens ical story, we apply one of these replacements sampled uniformly, resulting in stories such as: ", "page_idx": 20, "bbox": [107, 646.3115234375, 505, 669.2255249023438], "page_size": [612.0, 792.0]}
{"layout": 139, "type": "text", "text": "•  Ability to swim has a direct effect on studying habit and exam score. Studying habit has a direct effect on exam score. •  Gender has a direct effect on department competitiveness and peanut allergy. Department competitiveness has a direct effect on peanut allergy. ", "page_idx": 20, "bbox": [135, 676.5725708007812, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 140, "type": "text", "text": "•  Liking spicy food has a direct effect on relationship status. Appearance has a direct effect on relationship status. •  Playing card games has a direct effect on diabetes and lifespan. Smoking has a direct effect on diabetes and lifespan. Diabetes has a direct effect on lifespan. Smoking is unobserved. ", "page_idx": 21, "bbox": [135, 72.757568359375, 505, 118.98351287841797], "page_size": [612.0, 792.0]}
{"layout": 141, "type": "text", "text": "For a full list of the replacements and how the replacements are made, check out the code. ", "page_idx": 21, "bbox": [106, 126.95257568359375, 466.7234802246094, 138.95750427246094], "page_size": [612.0, 792.0]}
{"layout": 142, "type": "text", "text": "A.8 Explanation Template ", "text_level": 1, "page_idx": 21, "bbox": [107, 147, 229, 159], "page_size": [612.0, 792.0]}
{"layout": 143, "type": "text", "text": "Step    $\\textcircled{\\scriptsize{1}}$  Extract the causal graph: The causal graph expressed in the context is: \"  $\\mathcal{G}^{\\prime}$  \". ", "page_idx": 21, "bbox": [106, 161.40460205078125, 438.7884216308594, 173.40953063964844], "page_size": [612.0, 792.0]}
{"layout": 144, "type": "text", "text": "Step    $\\circledast$  Identify the query type: The query type of the above question is \" query _ type \". ", "page_idx": 21, "bbox": [106, 183.22259521484375, 454.2774353027344, 195.22752380371094], "page_size": [612.0, 792.0]}
{"layout": 145, "type": "text", "text": "Step    $\\textcircled{3}$  Formulate the query to its symbolic form: The formal form of the query is \" symbolic _ expression \". ", "page_idx": 21, "bbox": [106, 205, 505, 227.9545135498047], "page_size": [612.0, 792.0]}
{"layout": 146, "type": "text", "text": "Step    $\\clubsuit$  Collect all the available data: The available data are:   $\"d\"$  ", "page_idx": 21, "bbox": [106, 237.767578125, 365, 249.7725067138672], "page_size": [612.0, 792.0]}
{"layout": 147, "type": "text", "text": "Step    $\\mathfrak{G}$  Derive the estimand: Based on the graph structure and causal query, the question can be simplified into estimand \" est \". ", "page_idx": 21, "bbox": [106, 259.5865478515625, 505, 282.50048828125], "page_size": [612.0, 792.0]}
{"layout": 148, "type": "text", "text": "Step    $\\mathfrak{G}$  Solve for the estimand: Plug in the available data \"  $\"d\"$   into \" est \".\n\n  $\\mathrm{est}(\\pmb{d})\n\n$   $\\approx\\mathrm{{floor}}(a)$  ", "page_idx": 21, "bbox": [106, 292.31353759765625, 396, 326], "page_size": [612.0, 792.0]}
{"layout": 149, "type": "text", "text": "Since the estimate for the estimand is  $\\operatorname{flat}(a)$  , the overall answer to the question is    $\\operatorname{b o o l}(a)$  . ", "page_idx": 21, "bbox": [106, 335.94952392578125, 476.5746154785156, 348], "page_size": [612.0, 792.0]}
{"layout": 150, "type": "text", "text": "B Experimental Details ", "text_level": 1, "page_idx": 21, "bbox": [106, 369, 237, 383], "page_size": [612.0, 792.0]}
{"layout": 151, "type": "text", "text": "B.1 C AUSAL C O T Prompt ", "text_level": 1, "page_idx": 21, "bbox": [106, 390, 226, 402], "page_size": [612.0, 792.0]}
{"layout": 152, "type": "text", "text": "Q:  [question from the dataset] ", "page_idx": 21, "bbox": [106, 405.20751953125, 261.66278076171875, 417.99951171875], "page_size": [612.0, 792.0]}
{"layout": 153, "type": "text", "text": "Guidance: Address the question by following the steps below: ", "page_idx": 21, "bbox": [106, 422.1915283203125, 355.4808349609375, 434.19647216796875], "page_size": [612.0, 792.0]}
{"layout": 154, "type": "text", "text": "Step 1) Extract the causal graph: Identify the causal graph that depicts the relationships in the scenario. The diagram should simply consist of edges denoted in \"var1  $->$   var2\" format, separated by commas. ", "page_idx": 21, "bbox": [106, 439.1755676269531, 505, 462.0904846191406], "page_size": [612.0, 792.0]}
{"layout": 155, "type": "text", "text": "Step 2) Determine the query type: Identify the type of query implied by the main question. Choices include \"marginal probability\", \"conditional probability\", \"explaining away effect\", \"backdoor ad- justment set\", \"average treatment effect\", \"collider bias\", \"normal counter factual question\", \"average treatment effect on treated\", \"natural direct effect\" or \"natural indirect effect\". Your answer should only be a term from the list above, enclosed in quotation marks. ", "page_idx": 21, "bbox": [106, 467.0695495605469, 505, 522.7105102539062], "page_size": [612.0, 792.0]}
{"layout": 156, "type": "text", "text": "Step 3) Formalize the query: Translate the query into its formal mathematical expression based on its type, utilizing the \"do(·)\" notation or counter factual notations as needed. ", "page_idx": 21, "bbox": [106, 527.6905517578125, 505, 550.6044921875], "page_size": [612.0, 792.0]}
{"layout": 157, "type": "text", "text": "Step 4) Gather all relevant data: Extract all the available data. Your answer should contain nothing but marginal probabilities and conditional probabilities in the form  $\"\\mathrm{P}(\\ldots){=}{\\ldots}\"$   or   $\"\\mathrm{P}(...|...){=}{...}\"$  , each probability being separated by a semicolon. Stick to the previously mentioned denotations for the variables. ", "page_idx": 21, "bbox": [106, 555.5835571289062, 505, 600.3164672851562], "page_size": [612.0, 792.0]}
{"layout": 158, "type": "text", "text": "Step 5) Deduce the estimand using causal inference: Given all the information above, deduce the estimand using skills such as do-calculus, counter factual prediction, and the basics of probabilities. Answer step by step. ", "page_idx": 21, "bbox": [106, 605.2955322265625, 505, 639.1184692382812], "page_size": [612.0, 792.0]}
{"layout": 159, "type": "text", "text": "Step 6) Calculate the estimand: Insert the relevant data in Step 4 into the estimand, perform basic arithmetic calculations, and derive the final answer. There is an identifiable answer. Answer step by step. ", "page_idx": 21, "bbox": [106, 644.0985717773438, 505, 677.9215087890625], "page_size": [612.0, 792.0]}
{"layout": 160, "type": "text", "text": "A:  [LLM previous response] ", "page_idx": 21, "bbox": [106, 682.9005737304688, 240.3823699951172, 695.6925659179688], "page_size": [612.0, 792.0]}
{"layout": 161, "type": "text", "text": "Q: Based on all the reasoning above, output one word to answer the initial question with just \"Yes\" or \"No\". ", "page_idx": 21, "bbox": [106, 699.8855590820312, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 162, "type": "text", "text": "A:  [LLM final answer] ", "page_idx": 22, "bbox": [106, 72.757568359375, 214.23056030273438, 85.54954528808594], "page_size": [612.0, 792.0]}
{"layout": 163, "type": "text", "text": "C Additional Technical Background for Preliminaries ", "text_level": 1, "page_idx": 22, "bbox": [106, 94, 391, 108], "page_size": [612.0, 792.0]}
{"layout": 164, "type": "text", "text": "C.1 Graphical Models ", "text_level": 1, "page_idx": 22, "bbox": [107, 114, 210, 127], "page_size": [612.0, 792.0]}
{"layout": 165, "type": "text", "text": "We adopt the causal inference framework described in [ 61 ]. A causal graph  $G:=(V,E)$   consists of a  of    $k$   vertices    $V\\,:\\,\\{V_{1},.\\,.\\,.\\,,V_{k}\\}$   and directe edg  $\\pmb{{\\cal E}}\\,:=\\,\\{\\bar{e}_{i j}\\}$  , whe istence of each  $e_{i j}$   means that there is a direct causation from  $V_{i}$   to  $V_{j}$  , also denoted as  $V_{i}\\,\\rightarrow\\,V_{j}$   → . We also introduce some notations to describe the relative positions among the nodes. Following a standard assumption in causality (but see, e.g., [ 6 , we  $\\mathcal{G}$  rect acyclic graph (DAG),  $V_{i}$   as  $\\mathbf{PA}(V_{i}):=\\{V_{j}|e_{i j}\\in E\\}$   { |  ∈ } . We denote  descendants  $\\mathbf{DE}(V_{i}):=\\{V_{j}|V_{j}\\ {\\overset{.}{\\to}}\\ \\cdot\\cdot\\ {\\overset{.}{\\to}}\\ V_{i}\\in E\\}$   { |  →· · · →  ∈ }  a node  $V_{i}$   as all the nodes that have at least one direct path leading to a node. We call a node  $V_{k}$   as a  confounder  (i.e., common cause) of the other two  $V_{i}$  d    $V_{j}$   if    $e_{k i},e_{k j}\\in\\pmb{E}$  ; a  collider  (i.e., common effect) if    $e_{i k},e_{j k}\\in E$  ; and a  mediator  if  $e_{i k},e_{k j}\\in E$   ∈ . ", "page_idx": 22, "bbox": [106, 129, 505, 247.8621368408203], "page_size": [612.0, 792.0]}
{"layout": 166, "type": "text", "text": "Among all the variables in    $V$  , we use    $X$   and    $Y$   to denote two special variables, the treatment and effect, respectively. ", "page_idx": 22, "bbox": [106, 243.96258544921875, 505, 266.87652587890625], "page_size": [612.0, 792.0]}
{"layout": 167, "type": "text", "text": "C.2 Illustration of the Three Rungs of the Causal Ladder ", "text_level": 1, "page_idx": 22, "bbox": [107, 273, 358, 285], "page_size": [612.0, 792.0]}
{"layout": 168, "type": "text", "text": "In Figure  7 , we illustrate the difference among the three rungs by enumerating what actions are performed on the variables other than target variables    $X$   and  $Y$  . ", "page_idx": 22, "bbox": [106, 288.1995544433594, 505, 311.1134948730469], "page_size": [612.0, 792.0]}
{"layout": 169, "type": "image", "page_idx": 22, "img_path": "layout_images/2312.04350v3_10.jpg", "img_caption": "Figure 7: The Causal Ladder consists of three rungs: association, intervention and counter factual s. We color in blue the treatment  $X$   and effect    $Y$  , as well as the actions on  $X$  . We color in orange words about how to get the estimand, and we use the orange circle to include all the non-descendants of    $X$  . ", "bbox": [105, 319, 505, 444], "page_size": [612.0, 792.0], "ocr_text": "Rung 3. Counterfactuals\n\nRung 1. Association\n\nRung 2. Intervention\n\nThe correlation of X and Y, ie., P(Y|X), flows\nthrough all undirected paths:\n\n(a) Direct causation path\n\nthe confounder Z\n\ndo(Xx)\n\nDirect intevention on X\ncuts off all its parents\n\nAverage over all the non-descendants\nof X to get PLY | do(X))..\n\nForce X to bé the\ncounterfactyal value\n\n“\\To completely isolate the effect of X, we\n‘look at the counterfactual P(Y,¢ | X=x).\n\nNw ,”’ Namely, we infer all non-descendants\nof X as if X were still the original value x.\n\n", "vlm_text": "The image presents a diagram of the Causal Ladder, which has three rungs: Association, Intervention, and Counterfactuals.\n\n1. **Rung 1: Association**\n   - Shows the correlation of variables \\(X\\) and \\(Y\\), denoting \\(\\text{P}(Y|X)\\).\n   - Includes direct causation and a backdoor path through a confounder \\(Z\\).\n\n2. **Rung 2: Intervention**\n   - Illustrates doing an intervention on \\(X\\) (denoted as \\(\\text{do}(X)\\)), cutting off its parents.\n   - Emphasizes averaging over all non-descendants of \\(X\\) to derive \\(\\text{P}(Y|\\text{do}(X))\\).\n\n3. **Rung 3: Counterfactuals**\n   - Involves forcing \\(X\\) to take a counterfactual value \\(x'\\).\n   - Highlights inferring all non-descendants of \\(X\\) with the counterfactual condition \\(\\text{P}_{Y_x}(x)\\).\n\nThe treatments and actions on \\(X\\) are highlighted in blue, whereas the methods for obtaining estimands and the non-descendants of \\(X\\) are represented in orange."}
{"layout": 170, "type": "text", "text": "C.3 Causal Inference Methods ", "text_level": 1, "page_idx": 22, "bbox": [106, 490, 245, 501], "page_size": [612.0, 792.0]}
{"layout": 171, "type": "text", "text": "We introduce do-calculus which can downgrade the Rung-2 queries to Rung-1 quantities when it is applicable, and counter factual predictions which downgrade the Rung-3 queries. ", "page_idx": 22, "bbox": [106, 504.54254150390625, 505, 527.4564819335938], "page_size": [612.0, 792.0]}
{"layout": 172, "type": "text", "text": "C.3.1 Do-Calculus ", "text_level": 1, "page_idx": 22, "bbox": [107, 533, 194, 544], "page_size": [612.0, 792.0]}
{"layout": 173, "type": "text", "text": "Do-Operator as a Notation As mentioned in Rung 2, the  do -operator is a convenient notation to represent an intervention on a variable. For example,    $\\operatorname{do}(X=x)$   sets the value of variable  $X$   to  $x$  . ", "page_idx": 22, "bbox": [106, 544.6409301757812, 505, 568], "page_size": [612.0, 792.0]}
{"layout": 174, "type": "text", "text": "Three Inference Rules for Climbing the Ladder Do-calculus is a set of rules that allows us to answer higher-rung questions using lower-rung quantities, such as probability distributions of Rung 1. Given a causal graphical model with and four disjoint sets of variables    $X,Y,Z$  , and  $W$  , and a joint probability distribution that is Markov and faithful to the graph, do-calculus contains the following three rules: ", "page_idx": 22, "bbox": [106, 571.9468994140625, 505, 627.9464721679688], "page_size": [612.0, 792.0]}
{"layout": 175, "type": "text", "text": "Rule  $I$   (Insertion/deletion of observations): ", "page_idx": 22, "bbox": [106, 632.3055419921875, 280.3627624511719, 644.2008666992188], "page_size": [612.0, 792.0]}
{"layout": 176, "type": "equation", "text": "\n$$\nP(Y|\\operatorname{do}(X),Z,W)=P(Y|\\operatorname{do}(X),W)\\;,\n$$\n ", "text_format": "latex", "page_idx": 22, "bbox": [219, 648, 391, 662], "page_size": [612.0, 792.0]}
{"layout": 177, "type": "text", "text": "if    $Y$   and  $Z$   are   $\\mathbf{d}\\cdot$  -separat  by    $X\\cup W$   in    $G^{*}$  , the graph obtained from    $\\mathcal{G}$   by removing all arrows pointing into variables in  X . ", "page_idx": 22, "bbox": [106, 666.4495849609375, 505, 689.363525390625], "page_size": [612.0, 792.0]}
{"layout": 178, "type": "text", "text": "Rule 2 (Action/observation exchange): ", "page_idx": 22, "bbox": [106, 693.7225341796875, 261.3541259765625, 705.6178588867188], "page_size": [612.0, 792.0]}
{"layout": 179, "type": "equation", "text": "\n$$\nP(Y|\\operatorname{do}(X),\\operatorname{do}(Z),W)=P(Y|\\operatorname{do}(X),Z,W)\\;,\n$$\n ", "text_format": "latex", "page_idx": 22, "bbox": [203, 709, 406, 723], "page_size": [612.0, 792.0]}
{"layout": 180, "type": "text", "text": "if    $Y$   and  $Z$   are   $\\mathbf{d}$  -separat  by    $X\\cup W$   in    $G^{\\dagger}$  , the graph obtained fro  $\\mathcal{G}$   by removing all arrows pointing into variables in  X  and all arrows pointing out of variables in  Z . ", "page_idx": 23, "bbox": [107, 72, 505, 95.67150115966797], "page_size": [612.0, 792.0]}
{"layout": 181, "type": "text", "text": "Rule 3 (Insertion/deletion of actions): ", "page_idx": 23, "bbox": [107, 100.029541015625, 258.22589111328125, 111.92488861083984], "page_size": [612.0, 792.0]}
{"layout": 182, "type": "equation", "text": "\n$$\nP(Y|\\operatorname{do}(X),\\operatorname{do}(Z),W)=P(Y|\\operatorname{do}(X),W)\\;,\n$$\n ", "text_format": "latex", "page_idx": 23, "bbox": [209, 113, 401, 126], "page_size": [612.0, 792.0]}
{"layout": 183, "type": "text", "text": "if  $Y$   and  $Z$   are d-separate y  $X\\cup W$   in    $G^{\\ddagger}$  the graph obtained from    $\\mathcal{G}$   by first removing all arrows pointing into variables in  X  (thus creating  $G^{*}$  ) and then removing all arrows pointing into variables in    $Z$   that are not ancestors of any variable in    $W$   in  $G^{*}$  . ", "page_idx": 23, "bbox": [107, 128, 505, 162.5084686279297], "page_size": [612.0, 792.0]}
{"layout": 184, "type": "text", "text": "These rules are sound and complete [ 85 ]. Namely, iff we have all the terms on the right hand side, then the causal term on the left hand side is identifiable. ", "page_idx": 23, "bbox": [107, 166.8665771484375, 505, 189.78050231933594], "page_size": [612.0, 792.0]}
{"layout": 185, "type": "text", "text": "Example Application of Do-Calculus Taking the example in Figure  2 ,  $g_{1}$   maps the query type ATE to its symbolic expression  $\\mathbb{E}[Y|\\operatorname{do}(X=1)]-\\mathbb{E}[Y|\\operatorname{do}(X=0)]$  . ", "page_idx": 23, "bbox": [107, 193.22691345214844, 505, 217], "page_size": [612.0, 792.0]}
{"layout": 186, "type": "text", "text": "Next,    $g_{2}$   further simplifies the estimand given the confounding graph, as in the flow chart in the middle of Figure  2 : ", "page_idx": 23, "bbox": [107, 220.85858154296875, 505, 243.7725067138672], "page_size": [612.0, 792.0]}
{"layout": 187, "type": "equation", "text": "\n$$\n\\begin{array}{l}{\\mathrm{ATE}:=\\mathbb{E}[Y|\\operatorname{do}(X=1)]-\\mathbb{E}[Y|\\operatorname{do}(X=0)]}\\\\ {\\qquad=\\displaystyle\\sum_{z}P(Z=z)[\\mathbb{E}(Y|X=1,Z=z)-\\mathbb{E}(Y|X=0,Z=z)]\\:,}\\end{array}\n$$\n ", "text_format": "latex", "page_idx": 23, "bbox": [163, 243.25, 447, 286], "page_size": [612.0, 792.0]}
{"layout": 188, "type": "text", "text": "which which resolves all the  $\\mathrm{{do}(\\cdot)}$   terms to probability terms. This example shows the famous backdoor adjustment in do-calculus [ 59 ]. ", "page_idx": 23, "bbox": [107, 287, 505, 310.031494140625], "page_size": [612.0, 792.0]}
{"layout": 189, "type": "text", "text": "C.3.2 Three Steps for Counter factual Prediction ", "text_level": 1, "page_idx": 23, "bbox": [106, 314, 321, 327], "page_size": [612.0, 792.0]}
{"layout": 190, "type": "text", "text": "Given a SCM    $M$  , distribution on the exogenous variables  $P(u)$  , and evidence    $e$   from the model  $\\langle M,P(u)\\rangle$  , t e probabili nter factual \"if    $X$   had been  $x$   then    $Y$  would have been y, given we observed  e ,” denoted  $P(Y_{x}=y|e)$  | , can be evaluated using the following three steps [ 67 ]: ", "page_idx": 23, "bbox": [107, 328, 505, 368.66607666015625], "page_size": [612.0, 792.0]}
{"layout": 191, "type": "text", "text": "Abduction:  Update the probability distribution  $P(u)$   by the evidence    $e$   to obtain    $P(u|e)$  ", "page_idx": 23, "bbox": [107, 365.8610534667969, 459, 378.69287109375], "page_size": [612.0, 792.0]}
{"layout": 192, "type": "text", "text": "Action:  Modify    $M$   by the action    $d o(X=x)$  , i.e. replace  $X$   with    $X=x$   in the structural equations, to obtain the modified SCM    $M_{x}$  ", "page_idx": 23, "bbox": [107, 382, 505, 405.5375061035156], "page_size": [612.0, 792.0]}
{"layout": 193, "type": "text", "text": "Prediction:  Use the modified model    $\\langle M_{x},P(u|e)\\rangle$  , to compute the probability of    $Y=y$  . ", "page_idx": 23, "bbox": [107, 409.498046875, 462.8826599121094, 428.66607666015625], "page_size": [612.0, 792.0]}
{"layout": 194, "type": "text", "text": "D Previous Results on CL ADDER  v1.0 ", "text_level": 1, "page_idx": 23, "bbox": [106, 430, 312, 444], "page_size": [612.0, 792.0]}
{"layout": 195, "type": "text", "text": "D.1 Dataset Statistics for v1.0 ", "text_level": 1, "page_idx": 23, "bbox": [105, 451, 241, 462], "page_size": [612.0, 792.0]}
{"layout": 196, "type": "table", "page_idx": 23, "img_path": "layout_images/2312.04350v3_11.jpg", "table_footnote": "Table 5: Statistics of our CL ADDER  data v1.0. ", "bbox": [106, 469, 356, 622], "page_size": [612.0, 792.0], "ocr_text": "Total | Rung! Rung2  Rung3\n\nSize\n\n# Samples 10,560 | 3,288 3,288 3,984\nQuestion\n\n# Sentences/Sample 6.85 6.00 7.00 7.25\n\n# Words/Sample 94.47 76.41 96.84 103.42\n\n# Nodes/Graph 3.54 3.54 3.55 3.54\n\n# Edges/Graph 3.44 3.41 3.43 3.46\nAnswer\n\nPositive Class (%) 50 50 50 50\nExplanations\n\n#Sentences/Sample = 13.11 12.04 13.76 13.83\n\n# Words/Sample 146.82 | 141.88 147.88 151.30\n\n", "vlm_text": "The table provides a breakdown of data characteristics across different categories labeled as \"Total,\" \"Rung 1,\" \"Rung 2,\" and \"Rung 3.\"\n\n1. **Size**:\n   - Total samples: 10,560\n   - Rung 1: 3,288 samples\n   - Rung 2: 3,288 samples\n   - Rung 3: 3,984 samples\n\n2. **Question**:\n   - Average sentences per sample: \n     - Total: 6.85\n     - Rung 1: 6.00\n     - Rung 2: 7.00\n     - Rung 3: 7.25\n   - Average words per sample: \n     - Total: 94.47\n     - Rung 1: 76.41\n     - Rung 2: 96.84\n     - Rung 3: 103.42\n   - Average nodes per graph:\n     - Total: 3.54\n     - Rung 1: 3.54\n     - Rung 2: 3.55\n     - Rung 3: 3.54\n   - Average edges per graph:\n     - Total: 3.44\n     - Rung 1: 3.41\n     - Rung 2: 3.43\n     - Rung 3: 3.46\n\n3. **Answer**:\n   - Positive class percentage is consistently 50 across all categories.\n\n4. **Explanations**:\n   - Average sentences per sample:\n     - Total: 13.11\n     - Rung 1: 12.04\n     - Rung 2: 13.76\n     - Rung 3: 13.83\n   - Average words per sample:\n     - Total: 146.82\n     - Rung 1: 141.88\n     - Rung 2: 147.88\n     - Rung 3: 151.30"}
{"layout": 197, "type": "image", "page_idx": 23, "img_path": "layout_images/2312.04350v3_12.jpg", "img_caption": "Figure 8: Distributions of query types in our dataset v1.0. ", "bbox": [402, 483, 507, 621], "page_size": [612.0, 792.0], "ocr_text": "", "vlm_text": "The image is a circular chart that illustrates the distribution of different query types in a dataset labeled as \"v1.0\". The chart is divided into three main sections or \"rungs\", each containing different types of queries.\n\n- **Rung 1** (Green Section): Represents probabilistic queries, including \"Cond. Prob.\" (conditional probability) and \"Marg. Prob.\" (marginal probability).\n- **Rung 2** (Blue Section): Contains causal inference queries, specifically \"ATE\" (Average Treatment Effect) and \"Adjust. Set\".\n- **Rung 3** (Orange Section): Encompasses more complex causal reasoning queries such as \"Counterf.\" (Counterfactual), \"NDE\" (Natural Direct Effect), \"NIE\" (Natural Indirect Effect), and \"ATT\" (Average Treatment effect on the Treated).\n\nThe chart is visually structured to show progression or hierarchy among these query types, with Rung 1 likely representing more basic types of queries, progressing to more complex queries in Rung 3."}
{"layout": 198, "type": "text", "text": "Our data-generating procedure has the potential to algorithmic ally generate very large amounts of questions. In practice, we pick a dataset size that is large enough to be representative, and at the same time not too large to be problematic given the expensive inference costs of LLMs. We therefore set our dataset size to be 10K. We report the statistics of our dataset in Table  5 . ", "page_idx": 23, "bbox": [107, 628.9765625, 505, 673.70849609375], "page_size": [612.0, 792.0]}
{"layout": 199, "type": "text", "text": "The dataset roughly balanced across the query types, graph structures, stories, and ground-truth answers (as seen in Figure  8 ). Note that there are some slight adjustments such as more samples for ATE because it allows us to test various techniques, including backdoor and front door adjustments. More details on our design choices can be found in Appendix  A.4 . ", "page_idx": 23, "bbox": [107, 678.0675659179688, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 200, "type": "table", "page_idx": 24, "img_path": "layout_images/2312.04350v3_13.jpg", "table_caption": "D.2 Main Results on v1.0 ", "table_footnote": "Table 6: Performance of all models on our CL ADDER  dataset v1.0. We report the overall accuracy (Acc.), and also fine-grained accuracy by rung and by empirical alignment. ", "bbox": [105, 73, 504, 238], "page_size": [612.0, 792.0], "ocr_text": "Acc. by Rung\n\nAcc. by Empirical Alignment\n\nOverall Ace: 1 2 3 Anti-C. Nonsens. Comm.\nRandom 49.27 50.28 48.40 49.12 | 49.69 49.01 49.12\nLLaMa 45.22 63.33 31.10 41.45 | 45.31 45.21 45.12\nAlpaca 45.54 63.33 31.57 41.91 | 45.94 45.21 45.49\nGPT-3 Non-Instr. (davinci) 47.42 63.88 32.99 44.89 47.0 48.28 46.97\nGPT-3 Instr. (text-davinci-001) 57.07 63.95 63.63 48.04 | 59.12 57.81 54.28\nGPT-3 Instr. (text-davinci-002) 56.24 46.03 69.55 55.04 | 54.75 59.65 54.31\nGPT-3 Instr. (text-davinci-003) 62.69 58.0 80.83 54.52 | 63.93 62.09 62.05\nGPT-3.5 (queried in May 2023) 61.71 65.12 69.9 54.11 | 65.43 55.15 64.55\nGPT-4 (queried in May 2023) 64.28 53.94 81.87 63.11 | 65.75 60.87 66.21\n+ CAUSALCOT 66.64 61.67 86.13 58.23 | 69.32 63.02 67.60\n\n", "vlm_text": "The table presents accuracy results for various models evaluated across different dimensions. Here's a breakdown:\n\n1. **Overall Acc.** (Overall Accuracy):\n   - Random: 49.27\n   - LLama: 45.22\n   - Alpaca: 45.54\n   - GPT-3 Non-Instr. (davinci): 47.42\n   - GPT-3 Instr. (text-davinci-001): 57.07\n   - GPT-3 Instr. (text-davinci-002): 56.24\n   - GPT-3 Instr. (text-davinci-003): 62.69\n   - GPT-3.5 (queried in May 2023): 61.71\n   - GPT-4 (queried in May 2023): 64.28\n   - + CausalCoT: 66.64\n\n2. **Acc. by Rung** (Accuracy by Rung Levels 1, 2, 3):\n   - Random: 50.28, 48.40, 49.12 respectively\n   - LLama: 63.33, 31.10, 41.45 respectively\n   - Alpaca: 63.33, 31.57, 41.91 respectively\n   - GPT-3 Non-Instr.: 63.88, 32.99, 44.89 respectively\n   - GPT-3 Instr. (text-davinci-001): 63.95, 63.63, 48.04 respectively\n   - GPT-3 Instr. (text-davinci-002): 46.03, 69.55, 55.04 respectively\n   - GPT-3 Instr. (text-davinci-003): 58.0, 80.83, 54.52 respectively\n   - GPT-3.5: 65.12, 69.9, 54.11 respectively\n   - GPT-4: 53.94, 81.87, 63.11 respectively\n   - + CausalCoT: 61.67, 86.13, 58.23 respectively\n\n3. **Acc. by Empirical Alignment** (Anti-C., Nonsens., Comm.):\n   - Random: 49.69, 49.01, 49.12 respectively\n   - LLama: 45.31, 45.21, 45.12 respectively\n   - Alpaca: 45.94, 45.21, 45.49 respectively\n   - GPT-3 Non-Instr.: 47.0, 48.28, 46.97 respectively\n   - GPT-3 Instr. (text-davinci-001): 59.12, 57.81, 54.28 respectively"}
{"layout": 201, "type": "text", "text": "We compare the performance of all models in Table  6 . First, we can see that the causal reasoning task in CL ADDER  is in general very challenging for all models. And models such as the earlier, non-instruction-tuned GPT-3 and both LLaMa and Alpaca are no better than random performance. With instruction-tuning, models start to show some improvement. And amongst all, our C AUSAL C O T achieves the highest performance of   $66.64\\%$  , which is 2.36 points better than vanilla GPT-4. ", "page_idx": 24, "bbox": [107, 241.841552734375, 505, 297.4834899902344], "page_size": [612.0, 792.0]}
{"layout": 202, "type": "text", "text": "Moreover, from the accuracy by empirical alignment level in Table  6 , we can see that the original GPT-4 model performs the best on common sens ical data, but 5.34 points worse on nonsensical data. However, our C AUSAL C O T enhances the reasoning ability across all levels, with substantial improvement on anti-common sens ical data and nonsensical data, indicating that C AUSAL C O T is particularly beneficial on unseen data. ", "page_idx": 24, "bbox": [107, 303.7675476074219, 505, 359.40850830078125], "page_size": [612.0, 792.0]}
{"layout": 203, "type": "text", "text": "D.3 Ablation Study on v1.0 ", "text_level": 1, "page_idx": 24, "bbox": [106, 368, 231, 380], "page_size": [612.0, 792.0]}
{"layout": 204, "type": "text", "text": "We conduct an ablation study for our multi-step C AUSAL C O T. We ablate each of the four sub questions, and observe in Table  7  that classifying the query type and formalizing it has the most effect on the model’s perfor- mance, which might be because that they are the crucial formalization step in order to do the causal inference correctly. Meanwhile, removing Steps    $\\textcircled{\\scriptsize{1}}$  and    $\\clubsuit$  , which are mostly about parsing the prompt correctly, have the least impact on performance. ", "page_idx": 24, "bbox": [108, 383.91156005859375, 396, 461.3714904785156], "page_size": [612.0, 792.0]}
{"layout": 205, "type": "table", "page_idx": 24, "img_path": "layout_images/2312.04350v3_14.jpg", "bbox": [409, 388, 500, 451], "page_size": [612.0, 792.0], "ocr_text": "CAUSALCOT\nw/o Step ©\nw/o Step ®\nw/o Step ®\nw/o Step ©\n\nAcc.\n66.64\n64.54\n63.74\n63.43\n64.47\n", "vlm_text": "The table presents accuracy (Acc.) values for a method called CAUSALCoT and variations of it that omit specific steps. Here are the details:\n\n- **CAUSALCoT**: 66.64%\n- **w/o Step ①**: 64.54%\n- **w/o Step ②**: 63.74%\n- **w/o Step ③**: 63.43%\n- **w/o Step ④**: 64.47% \n\nIt shows the impact on accuracy when each step is removed."}
{"layout": 206, "type": "text", "text": "Table 7: Ablation study. ", "page_idx": 24, "bbox": [411.0509948730469, 455.6660461425781, 497.4601745605469, 466.4705505371094], "page_size": [612.0, 792.0]}
{"layout": 207, "type": "text", "text": "E More Experiments ", "text_level": 1, "page_idx": 24, "bbox": [106, 472, 226, 486], "page_size": [612.0, 792.0]}
{"layout": 208, "type": "text", "text": "E.1 Details of Our Error Analysis ", "text_level": 1, "page_idx": 24, "bbox": [106, 495, 259, 507], "page_size": [612.0, 792.0]}
{"layout": 209, "type": "text", "text": "For Step 2 about the query type prediction, we report the overall F1 classification score, and also F1 by rungs. For the rest of the steps, we manually annotate the correctness of 100 samples of C AUSAL C O T. We report the correctness of  est  by accuracy, and the correctness of the predicted set of available data by taking the F1 with the ground-truth    $^{d}$  . For Step 5, we report the accuracy of whether the model simplifies the estimand correctly to  $\\mathrm{est}^{\\prime}$    using causal inference, and also arithmetic correctness (Arith.). ", "page_idx": 24, "bbox": [107, 510.6505126953125, 505, 577.2005004882812], "page_size": [612.0, 792.0]}
{"layout": 210, "type": "text", "text": "E.2 ROSCOE Evaluation ", "text_level": 1, "page_idx": 24, "bbox": [106, 586, 224, 597], "page_size": [612.0, 792.0]}
{"layout": 211, "type": "text", "text": "We employed the ROSCOE suite of evaluation metrics on step-by-step text reasoning, as introduced by [ 25 ], to automate the evaluation of the outputs from C AUSAL C O T on 2,000 randomly sampled questions from our dataset. Differing from conventional metrics, ROSCOE is specifically designed to scrutinize the quality of large language model outputs, focusing on aspects such as semantic consistency, logicality, informative ness, fluency, and factuality, all evaluated within the context of step-by-step reasoning, rather than solely the final response. This allows for a more objective and comprehensive assessment of a model’s output, greatly aiding in the verification of its interpret ability. The results of this evaluation can be found in Table  8  and Figure  9 . We consider the model’s performance as unsatisfying if it falls out of the top quantile, namely receiving a score    $s\\in[0,1]$  smaller than 0.25 when the score should be minimized, or greater than 0.75 when it should be maximized. ", "page_idx": 24, "bbox": [107, 601.7035522460938, 505, 722.7994995117188], "page_size": [612.0, 792.0]}
{"layout": 212, "type": "text", "text": "We can see in the plot that the good-performing aspects are faithfulness to the original question, reasoning alignment with the ground truth, and absence of external hallucinations, which are consis- tently within the top quantile. This suggests that the model carries out accurate reasoning within the constraints of the fictitious world introduced in each question. ", "page_idx": 25, "bbox": [107, 72.757568359375, 505, 117.48949432373047], "page_size": [612.0, 792.0]}
{"layout": 213, "type": "text", "text": "However, there are some performance dips in redundancy, perplexity chain, and missing step metrics. The first two could potentially be attributed to complex elements such as graph notation, while the relatively lower “missing step” score warrants further investigation. Despite these observations, this analysis largely aligns with our qualitative understanding of the models’ good response ability in answering causal questions in our dataset. ", "page_idx": 25, "bbox": [107, 121.84857177734375, 505, 177.48948669433594], "page_size": [612.0, 792.0]}
{"layout": 214, "type": "table", "page_idx": 25, "img_path": "layout_images/2312.04350v3_15.jpg", "table_footnote": "Table 8: Statistics of ROSCOE scores evaluated on answers from C AUSAL C O T on 2,000 randomly sampled questions from our dataset. ", "bbox": [107, 187, 505, 422], "page_size": [612.0, 792.0], "ocr_text": "Mean Std Min 25% 50% 75% Max\nFaithfulness 0.89 0.02 0.83 0.88 0.89 0.90 0.93\nInformativeness Step 0.88 0.01 0.83 0.87 0.88 0.89 0.92\nInformativeness Chain 0.88 0.03 0.76 0.87 0.89 0.90 0.96\nFaithfulness Word 0.95 0.01 0.92 0.94 0.95 0.96 0.97\nRepetition Word 0.02 0.02 -0.00 0.00 0.02 0.04 0.05\nRepetition Step 0.02 0.01 -0.00 0.00 0.01 0.03 0.06\nReasoning Alignment 0.92 0.01 0.86 O91 0.92 0.93 0.95\nExternal Hallucination 0.97 0.02 0.84 0.96 0.97 0.98 0.99\nRedundancy 0.80 0.05 0.56 0.77 0.80 0.83 0.92\nCommon Sense Error 0.95 0.01 0.86 0.94 0.95 0.96 0.98\nMissing Step 0.78 0.03 0.58 0.76 0.78 0.80 0.88\nSemantic Coverage Step 0.99 0.01 0.95 0.98 0.99 0.99 1.00\nSemantic Coverage Chain 0.98 0.01 0.93 0.98 0.98 0.99 0.99\nDiscourse Representation 0.06 0.13 0.00 0.01 0.01 0.05 0.67\nCoherence Step Vs Step 0.14 0.27. 0.00 0.00 0.01 0.07 0.94\nPerplexity Step 0.02 0.01 0.00 0.02 0.02 0.03 0.07\nPerplexity Chain 0.17 0.07 0.05 O11 0.17 0.23 0.42\nPerplexity Step Max 0.00 0.00 0.00 0.00 0.00 0.01 0.02\nGrammar Step 0.93 0.04 0.77 0.90 0.93 0.96 0.99\nGrammar Step Max 0.53 0.35 0.02 0.12 0.65 0.85 0.99\n", "vlm_text": "The table contains statistics for various metrics related to some form of analysis, possibly in the context of language processing, machine learning, or data analysis judging by the metric names. For each metric, the table provides the following statistical measurements:\n\n1. **Mean**: The average score of the metric.\n2. **Std (Standard Deviation)**: Indicates the variability or dispersion of the scores.\n3. **Min**: The minimum score observed for the metric.\n4. **25%**: The first quartile, indicating that 25% of the scores fall below this value.\n5. **50%**: The median value (second quartile), which is the middle point of the data set.\n6. **75%**: The third quartile, showing that 75% of the scores are below this value.\n7. **Max**: The maximum score observed for the metric.\n\nThe metrics listed include:\n\n- Faithfulness\n- Informativeness (Step and Chain)\n- Faithfulness Word\n- Repetition (Word and Step)\n- Reasoning Alignment\n- External Hallucination\n- Redundancy\n- Common Sense Error\n- Missing Step\n- Semantic Coverage (Step and Chain)\n- Discourse Representation\n- Coherence Step Vs Step\n- Perplexity (Step and Chain)\n- Perplexity Step Max\n- Grammar\n- Grammar Step Max\n\nThese metrics appear to evaluate aspects such as faithfulness, informativeness, repetition, reasoning, hallucinations, redundancy, errors, coverage, discourse representation, coherence, perplexity, and grammar. Each metric is quantified by the statistical measures provided, illustrating their performance or extent across a particular dataset or model."}
{"layout": 215, "type": "text", "text": "F Comparison with Existing Causality-Related Datasets ", "text_level": 1, "page_idx": 25, "bbox": [106, 446, 403, 461], "page_size": [612.0, 792.0]}
{"layout": 216, "type": "text", "text": "We show in Table  9  the distinction of our work from all existing causality-related datasets that address either the causality-as-knowledge task, or the causality-as-language-comprehension task. ", "page_idx": 25, "bbox": [107, 467.30755615234375, 505, 490.22149658203125], "page_size": [612.0, 792.0]}
{"layout": 217, "type": "table", "page_idx": 26, "img_path": "layout_images/2312.04350v3_16.jpg", "table_footnote": "Table 9: Comparison of our dataset and existing causal or reasoning datasets. The aim of our dataset is to test the pure reasoning ability of LLMs on causal questions. For each dataset, we first identify whether its question types cover the three rungs: association (Assoc.), intervention (Interv.), and counter factual s (Counterf.). We also check what skill types the dataset tests: the application of causal inference methods (CI Method), formalization of causal queries, causal relation extraction from the given text (Causal RE), and qualitative reasoning. ", "bbox": [106, 239, 505, 542], "page_size": [612.0, 792.0], "ocr_text": "Question Types Skill Types\n\nFormalization Qualitative\nAssoc. Interv. Counterf. Cl Method of Causal Causal RE Reasoni\nae easoning\nQueries\nDatasets for Causality as Knowledge (Commonsense Causality)\nCOPA [2012] x v x x x x x\nEvent2Mind [2018] x v x x x x x\nATOMIC [2019] x v x x x x x\nSocialIQA [2019] x v x x x x x\nTimeTravel [2019] x v x x x x x\nGoal-Step [2020] x v x x x x x\nAbductive (ART) [2020] x v x x x x x\nCom2Sense [2021] x v x x x x x\nCRASS [2022] x x v x x x x\nDatasets for Causality as Language Comprehension (Causal Relation Extraction)\nSemEval2021 Task8 [2010] X x x x x v x\nEventCausality [2011] x x x x x v x\nCausal-TimeBank [2014] x x x x x v x\nCaTeRS [2016] x x x x x v x\nBECauSE [2017] x x x x x v x\nTellMeWhy [2021] x x x x x v x\nDatasets for Formal Causal Reasoning\nCorr2Cause [42] x v x v v x x\nCLADDER (Ours) v v v v J v v\n", "vlm_text": "The table categorizes datasets based on types of causality analysis and the skills they test. It is divided into three sections:\n\n1. **Datasets for Causality as Knowledge (Commonsense Causality):**\n   - Lists datasets like COPA, ATOMIC, etc.\n   - Evaluates them on question types (Association, Intervention, Counterfactual) and skill types (CI Method, Formalization of Causal Queries, Causal Relation Extraction, Qualitative Reasoning).\n\n2. **Datasets for Causality as Language Comprehension (Causal Relation Extraction):**\n   - Includes datasets like SemEval2021 Task8, EventCausality, etc.\n   - Similar evaluation criteria as above.\n\n3. **Datasets for Formal Causal Reasoning:**\n   - Includes Corr2Cause and CLADDER.\n   - Assessed on the same criteria.\n\nSymbols used:\n- ✔️: Indicates the presence of a specific feature in the dataset.\n- ❌: Indicates the absence of a specific feature in the dataset."}
{"layout": 218, "type": "image", "page_idx": 27, "img_path": "layout_images/2312.04350v3_17.jpg", "img_caption": "Figure 9: ROSCOE scores of answers from C AUSAL C O T on 2,000 randomly sampled questions from our dataset. ", "bbox": [106, 94, 506, 698], "page_size": [612.0, 792.0], "ocr_text": "faithfulness informativeness step informativeness chain\n\n- 7 ;\n400 500 | | 350 ;\n| x0 |\n400\nx00 | 20 |\n“ 20 350 ++ }\n| 100\n108 100 ip\n| 50 + + i\n° ° ° |\n0 02 Oa 0 02 04 06 08 10 00 02. 0. 06\nfaithfulness ww repetition word tooo repetition step\nI\nro | 0 ;\nm0 |\n00 | - I me\n0 : }\nsao | | | 3 fel\n400 ++ { | q j\n400 |\nrs es ee oo |] z\noy soo | |\nm0 |} t } |\n206 T 200 : :\noy 100\n|\n° ' ° : ° :\n° 02 04 os (10 00 02 04 06 08 10 00 02\nreasoning alignment external hallucination\n70 —\nwo fT T ws\nme soo |! | 150\nmm too 15\nai 300 }-\n300\n300 { | 7\n700 -\n100 | 100 Fs\n° ° 1 ° 1\n00 0204 08 10 00 0204 06 00 02\ncommon sense error missing step semantic coverage step\nT T T T\nsoo FT vol] | molt |\n700 —rTH 20 | | 700\n0 | 0 7\nsoo | ff me sii | u\n400 ++} : : aso | { 400\nisda +H ie oo a\n00 | | | I 0\n00 | se] 2 300\n° ° °\n0 02 om os 10 00 02 % 06 08 10 00 oo. os 10\nsemantic coverage chain discourse representation coherence step vs step\nx00\n0\n1000 al\n0 00 : 800\n00 0 {\n400\n400 | sate |\n70\n200 200\n° ° °\no 02 o4 oo | On oe 10 00 oo. 10\nperplexity step perplexity chain perplexity step max\n] ] ] 1 T\nas 175 | 3600]\n| 150 1400\n| 3200\neo | { { ws\n1000\n100\nae . wo\n0 ;\n200 | a 400 +] | |\n~ m0 i\n° ° ol .\n0 02 oa os 10 oe 08 10 00 02 08 06 08 10\ngrammar step grammar step max\n200\nws] Mt\n180} >\nws |\n100\nel\n|\n0\nill\n°\n\n00 02 04 06\n", "vlm_text": "The image contains multiple histograms displaying ROSCOE scores for different evaluation criteria related to answers from Causal CoT on a dataset of 2,000 randomly sampled questions. Each histogram represents a different metric:\n\n1. Faithfulness\n2. Informativeness Step\n3. Informativeness Chain\n4. Faithfulness WW\n5. Repetition Word\n6. Repetition Step\n7. Reasoning Alignment\n8. External Hallucination\n9. Redundancy\n10. Common Sense Error\n11. Missing Step\n12. Semantic Coverage Step\n13. Semantic Coverage Chain\n14. Discourse Representation\n15. Coherence Step vs Step\n16. Perplexity Step\n17. Perplexity Chain\n18. Perplexity Step Max\n19. Grammar Step\n20. Grammar Step Max\n\nEach plot has a similar x-axis ranging from 0 to 1, representing the score, while the y-axis reflects the frequency/count of answers achieving a particular score."}
