{"layout": 0, "type": "text", "text": "Retrieve and Reﬁne: Improved Sequence Generation Models For Dialogue ", "text_level": 1, "page_idx": 0, "bbox": [135, 68, 463, 103], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 1, "type": "text", "text": "Jason Weston, Emily Dinan and Alexander H. Miller Facebook AI Research ", "page_idx": 0, "bbox": [163, 128.531005859375, 436, 157.31539916992188], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 2, "type": "text", "text": "jase@fb.com, edinan@fb.com, ahm@fb.com ", "page_idx": 0, "bbox": [163, 158.2083282470703, 436, 170.7373809814453], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 3, "type": "text", "text": "Abstract ", "text_level": 1, "page_idx": 0, "bbox": [159, 223, 204, 236], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 4, "type": "text", "text": "Sequence generation models for dialogue are known to have several problems: they tend to produce short, generic sentences that are un- informative and unengaging. Retrieval models on the other hand can surface interesting re- sponses, but are restricted to the given retrieval set leading to erroneous replies that cannot be tuned to the speciﬁc context. In this work we develop a model that combines the two ap- proaches to avoid both their deﬁciencies: ﬁrst retrieve a response and then reﬁne it – the ﬁnal sequence generator treating the retrieval as ad- ditional context. We show on the recent C ON - V AI2 challenge task our approach produces responses superior to both standard retrieval and generation models in human evaluations. ", "page_idx": 0, "bbox": [89, 247.486572265625, 273, 438.8194885253906], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 5, "type": "text", "text": "1 Introduction ", "text_level": 1, "page_idx": 0, "bbox": [71, 474, 155, 489], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 6, "type": "text", "text": "Sequence generation models like Seq2Seq ( Sutskever et al. ,  2014 ) are increasingly popular for tasks such as machine translation (MT) and summarization, where generation is suitably constrained by the source sentence. However, obtaining good performance on dialogue tasks, where the context still allows many interpreta- tions, remains an open problem despite much recent work ( Serban et al. ,  2016 ). Several au- thors report the issue that they produce short, generic sentences containing frequent words – the so-called “I don’t know” problem – as that response can work as a reply in many instances, but is uninformative and unengaging. Retrieval models ( Ji et al. ,  2014 ) do not have this problem, but instead either produce engaging responses or else completely erroneous ones which they cannot tune to the speciﬁc context, as they can only produce a valid reply if it is in the retrieval set. ", "page_idx": 0, "bbox": [72, 497.08697509765625, 290, 727.0204467773438], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 7, "type": "text", "text": "", "page_idx": 0, "bbox": [307, 223.4199981689453, 525, 250.11447143554688], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 8, "type": "text", "text": "In this work we propose a Retrieve and Reﬁne model to gain the advantages of both methods, and avoid both their disadvantages. Models that produce an initial prediction and then reﬁne it are growing in traction in NLP. They have been used in MT and summarization either for reﬁnement of initial predictions ( Junczys-Dowmunt and Grund- kiewicz ,  2017 ;  Niehues et al. ,  2016 ;  Novak et al. , 2016 ;  Xia et al. ,  2017 ;  Grangier and Auli ,  2017 ) or combining with retrieval ( Gu et al. ,  2017 ;  Cao et al. ,  2018 ), as well as for sentence correction or reﬁnement without context ( Guu et al. ,  2017 ; Schmaltz et al. ,  2017 ). There is little work in ap- plying these methods to dialogue; one work we are aware of has been done concurrently with ours is Pandey et al.  ( 2018 ). The usefulness of our ap- proach is shown with detailed experiments on the ConvAI2 dataset 1   which is a chit-chat task to get to know the other speaker’s proﬁle, obtaining gen- erations superior to both retrieval and sequence generation models in human evaluations. ", "page_idx": 0, "bbox": [307, 250.92799377441406, 525, 535.0575561523438], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 9, "type": "text", "text": "2 Retrieve and Reﬁne ", "text_level": 1, "page_idx": 0, "bbox": [306, 546, 427, 560], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 10, "type": "text", "text": "The model we propose in this work is remark- ably straight-forward: we take a standard gener- ative model and concatenate the output of a re- trieval model to its usual input, and then generate as usual, training the model under this setting. ", "page_idx": 0, "bbox": [307, 569.0300903320312, 525, 636.3715209960938], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 11, "type": "text", "text": "For the generator, we use a standard Seq2Seq model: a 2-layer LSTM with attention. For the retriever, we use the Key-Value Memory Network ( Miller et al. ,  2016 ) already shown to perform well for this dataset ( Zhang et al. ,  2018 ), which attends over the dialogue history, to learn input and candi- date retrieval embeddings that match using cosine similarity. The top scoring utterance is provided as input to our Seq2Seq model in order to reﬁne it, prepended with a special separator token. For both models we use the code available in ParlAI 2 . At test time the retriever retrieves candidates from the training set. ", "page_idx": 0, "bbox": [307, 637.1860961914062, 525, 745.175537109375], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 12, "type": "text", "text": "", "page_idx": 1, "bbox": [72, 63.68701934814453, 290, 131.02951049804688], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 13, "type": "text", "text": "To train our model we ﬁrst precompute the re- trieval result for every dialogue turn in the train- ing set, but instead of using the top ranking results we rerank the top 100 predictions of each by their similarity to the label (in embedding space). Fol- lowing  Guu et al.  ( 2017 ) this should help avoid the problem of the reﬁnement being too far away from the original retrieval. We then append the cho- sen utterances to the input sequences used to train Seq2Seq. We refer to our model as  RetrieveN- Reﬁne , or  RetNRef  for short. We also consider two variants of the model in the following that we found improve the results. ", "page_idx": 1, "bbox": [72, 135.7760772705078, 290, 311.5116271972656], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 14, "type": "text", "text": "Use Retriever More In our vanilla model, we noticed there was not enough attention being paid to the retrieval utterance by the generator. As the input to Seq2Seq is the dialogue history concate- nated with the retrieval utterance, truncating the history is one way to pay more attention to the re- trieval. In particular for the ConvAI2 dataset we clip the initial proﬁle sentences at the start of the dialogue, forcing the model to more strongly rely on the retriever which still has them.   We refer to this modiﬁcation as  RetrieveNReﬁne + . ", "page_idx": 1, "bbox": [72, 333.9294128417969, 290, 482.9596862792969], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 15, "type": "text", "text": "Fix Retrieval Copy Errors Our model learns to sometimes ignore the retrieval (when it is bad), sometimes use it partially, and other times sim- ply copy it. However, when it is mostly copied but only changes a word or two, we observed it made mistakes more often than not, leading to less meaningful utterances. We thus also con- sider a variant that exactly copies the retrieval if the model generates with large word over- lap (we chose    ${>}60\\%$  ). Otherwise, we leave the generation untouched. We refer to this as RetrieveNReﬁne++.", "page_idx": 1, "bbox": [72, 505.3764953613281, 290, 667.9556884765625], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 16, "type": "table", "page_idx": 1, "img_path": "layout_images/W18-5713_0.jpg", "table_footnote": "Table 1: Perplexity on the ConvAI2 task test set with different types of retriever for RetNRef, see text. ", "bbox": [306, 61, 527, 182], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "RetNRef Retrieval Method | PPL\nNone (Vanilla Seq2Seq) 31.4\nRandom label 32.0\nMemory Network 31.8\nTrue label’s neighbor 25.9\nTrue label 9.2\n\n", "vlm_text": "The table presents a comparison of various retrieval methods used in conjunction with a sequence-to-sequence (Seq2Seq) model, by showing their associated perplexity (PPL) scores. The table has two columns: one for the \"RetNRef Retrieval Method\" and another for \"PPL\". \n\nThe retrieval methods listed are:\n1. None (Vanilla Seq2Seq) with a PPL of 31.4.\n2. Random label with a PPL of 32.0.\n3. Memory Network with a PPL of 31.8.\n4. True label’s neighbor with a PPL of 25.9.\n5. True label with a PPL of 9.2.\n\nLower PPL values indicate better model performance, with the \"True label\" method showing the best performance (lowest perplexity) among the methods tested."}
{"layout": 17, "type": "text", "text": "3 Experiments ", "text_level": 1, "page_idx": 1, "bbox": [306, 202, 391, 216], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 18, "type": "text", "text": "We conduct experiments on the recent ConvAI2 challenge dataset which uses a modiﬁed version of the PersonaChat dataset ( Zhang et al. ,  2018 ) (larger, and with different processing). The dataset consists of conversations between crowdworkers who were randomly paired and asked to act the part of a given persona (randomly assigned from 1155 possible personas, created by another set of workers), chat naturally, and get to know each other during the conversation. There are around 160,000 utterances in around 11,000 dialogues, with 2000 dialogues for validation and test, which use non-overlapping personas. ", "page_idx": 1, "bbox": [307, 224.43202209472656, 525, 400.1685485839844], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 19, "type": "text", "text": "3.1 Automatic Evaluation and Analysis ", "text_level": 1, "page_idx": 1, "bbox": [306, 410, 497, 422], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 20, "type": "text", "text": "Perplexity Dialogue is known to be notoriously hard to evaluate with automated metrics ( Liu et al. , 2016 ). In contrast to machine translation, there is much less constraint on the output with many valid answers with little word overlap, e.g. there are many answers to “what are you doing tonight?”. Nevertheless many recent papers report perplexity results in addition to human judgments. For the re- trieve and reﬁne case, perplexity evaluation is par- ticularly ﬂawed: if the retrieval points the model to a response that is very different from (but equally valid as) the true response, the model might focus on reﬁning that and get poor perplexity. ", "page_idx": 1, "bbox": [307, 427.1853332519531, 525, 603.3135986328125], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 21, "type": "text", "text": "We therefore test our model by considering various types of retrieval methods: (i) the best performing existing retriever model, the Memory Network approach from  Zhang et al.  ( 2018 ) (re- trieving from the training set), (ii) a retriever that returns a random utterance from the training set, (iii) the true label given in the test set, and (iv) the closest nearest neighbor from the training set ut- terances to the true label, as measured by the em- bedding space of the Memory Network retriever model. While (iii) and (iv) cannot be used in a de- ployed system as they are unknown, they can be ", "page_idx": 1, "bbox": [307, 603.8451538085938, 525, 766.0315551757812], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 22, "type": "table", "page_idx": 2, "img_path": "layout_images/W18-5713_1.jpg", "table_caption": "Table 2: Output sequence statistics for the methods. Seq2Seq generates shorter sentences with more com- mon words than humans, which RetNRef alleviates. ", "bbox": [71, 61, 291, 222], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "Word | Char | Rare Word %\nMethod ent ent | <100| <Ik\nSeq2Seq 11.7 | 40.5 | 0.4% | 5.8%\nRetNRef 11.8 | 40.4 | 1.1% | 6.9%\nRetNRef* 12.1 | 45.0 | 1.7% | 10.1%\nRetNReft+ | 12.7 | 48.1 | 2.3% | 10.9%\nMemNet 13.1 | 54.5 | 4.0% | 15.3%\nHuman 13.0 | 54.6 | 3.0% | 11.5%\n\n", "vlm_text": "The table shows a comparison of different methods based on four metrics: Word Count (cnt), Character Count (cnt), Rare Word Percentage for words appearing less than 100 times, and Rare Word Percentage for words appearing less than 1,000 times. Here is the data presented in the table:\n\n1. **Seq2Seq**\n   - Word Count: 11.7\n   - Character Count: 40.5\n   - Rare Word % (<100): 0.4%\n   - Rare Word % (<1k): 5.8%\n\n2. **RetNRef**\n   - Word Count: 11.8\n   - Character Count: 40.4\n   - Rare Word % (<100): 1.1%\n   - Rare Word % (<1k): 6.9%\n\n3. **RetNRef⁺**\n   - Word Count: 12.1\n   - Character Count: 45.0\n   - Rare Word % (<100): 1.7%\n   - Rare Word % (<1k): 10.1%\n\n4. **RetNRef⁺⁺**\n   - Word Count: 12.7\n   - Character Count: 48.1\n   - Rare Word % (<100): 2.3%\n   - Rare Word % (<1k): 10.9%\n\n5. **MemNet**\n   - Word Count: 13.1\n   - Character Count: 54.5\n   - Rare Word % (<100): 4.0%\n   - Rare Word % (<1k): 15.3%\n\n6. **Human**\n   - Word Count: 13.0\n   - Character Count: 54.6\n   - Rare Word % (<100): 3.0%\n   - Rare Word % (<1k): 11.5%\n\nThis table appears to be measuring the efficacy and complexity of different methods for a particular task, likely in the domain of natural language processing or text generation, as indicated by the focus on word and character counts, and the frequency of rare words."}
{"layout": 23, "type": "table", "page_idx": 2, "img_path": "layout_images/W18-5713_2.jpg", "table_footnote": "Table 3: Word overlap between retrieved and gener- ated utterances in RetNRef, and between Seq2Seq and the Memory Network retriever (ﬁrst row). ", "bbox": [71, 233, 291, 352], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "Method <30% | 30-60% | 60-80% | >80%\nSeq2Seq 56% | 34% 1% 3%\nRetNRef 41% | 38% 13% 8%\nRetNReft 26% | 20% 12% 42%\nRetNReftt | 26% | 20% 0% 53%\n\n", "vlm_text": "The table presents a comparison of methods based on their performance categorized by different percentage ranges. The methods listed are Seq2Seq, RetNRef, RetNRef^+, and RetNRef^++. Each method's performance is shown across four percentage categories: <30%, 30-60%, 60-80%, and >80%.\n\n- **Seq2Seq method**: \n  - <30%: 56%\n  - 30-60%: 34%\n  - 60-80%: 7%\n  - >80%: 3%\n\n- **RetNRef method**:\n  - <30%: 41%\n  - 30-60%: 38%\n  - 60-80%: 13%\n  - >80%: 8%\n\n- **RetNRef^+ method**:\n  - <30%: 26%\n  - 30-60%: 20%\n  - 60-80%: 12%\n  - >80%: 42%\n\n- **RetNRef^++ method**:\n  - <30%: 26%\n  - 30-60%: 20%\n  - 60-80%: 0%\n  - >80%: 53%\n\nThis table likely demonstrates how each method performs in terms of certain criteria or metrics, with higher percentage values indicating better performance in specific ranges. RetNRef^++ has the most significant percentage of its performance in the >80% category, indicating it may be the most effective among the methods within this table's context."}
{"layout": 24, "type": "text", "text": "used as a sanity check: a useful retrieve and reﬁne should improve perplexity if given these as input. We also compare to a standard Seq2Seq model, i.e. no retrieval. ", "page_idx": 2, "bbox": [72, 375.0820007324219, 290, 428.87548828125], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 25, "type": "text", "text": "The results are given in Table  1 . They show that the RetNRef model can indeed improve perplexity with label neighbors or the label itself. However, surprisingly there is almost no difference between using no retrieval, random labels or our best re- triever. The RetNRef ++   model – that truncates the dialogue history and focuses more on the re- trieval utterance – does even worse in terms of perplexity: 48.4 using the Memory Network re- triever. However, poor perplexity does not mean human judgments of the generated sequences will not improve; in fact we will see that they do in the next section. How to automatically evaluate these kinds of models still remains an open problem. ", "page_idx": 2, "bbox": [72, 430.31201171875, 290, 619.5975341796875], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 26, "type": "text", "text": "Word Statistics Another way to measure the salience of a generation model is to compare it to human utterances in terms of word statistics. We analyze the word statistics of our models in Table 2 . Seq2Seq models are known to produce short sentences with more common words than humans. The statistics on the ConvAI2 dataset bear this out, where the Seq2Seq model responses have lower word and character counts and use fewer rare words than the human responses. The RetNRef model (using the Memory Network retriever, re- trieving from the training set) makes some im- provements in this regard, e.g. doubling the use of rare words (with frequency less than 100) and smaller gains for words with frequency less than 1000, but are still not close to human statistics. The RetNRef ++   model which boosts the use of the retrieval does better in this regard, making the statistics much closer to human ones. Of course these metrics do not measure whether the utter- ances are semantically coherent, but it is encour- aging to see a model using rare words as without this we believe it is hard for it to be engaging. ", "page_idx": 2, "bbox": [72, 630.5503540039062, 290, 766.031494140625], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 27, "type": "text", "text": "", "page_idx": 2, "bbox": [307, 63.68708038330078, 526, 239.42361450195312], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 28, "type": "text", "text": "Table  3  compares the word overlap between re- trieved and generated sentences in the RetNRef variants in order to measure if RetNRef is either ignoring the retriever, or else paying too much at- tention to and copying it. As comparison, the ﬁrst row also shows the overlap between the retriever and vanilla Seq2Seq which does not retrieve at all. The results show that RetNRef ++   has  ${>}80\\%$  word overlap with the retriever output around half  $(53\\%)$   of the time, whereas Seq2Seq and RetNRef very rarely overlap with the retriever (  $3\\%$   and   $8\\%$  of the time respectively have  ${>}80\\%$   overlap). This shows that our improved model  $\\mathbf{Set}\\mathbf{NRef}^{++}$    does use the retriever, but can also generate novel con- tent when it wants to, which a standard retriever cannot. ", "page_idx": 2, "bbox": [307, 241.5081329345703, 526, 457.8916931152344], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 29, "type": "text", "text": "3.2 Evaluation by Human Judgement Scores ", "text_level": 1, "page_idx": 2, "bbox": [307, 473, 523, 485], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 30, "type": "text", "text": "Following the protocol in  Zhang et al.  ( 2018 ), we asked humans to conduct short dialogues with our models (100 dialogues each of 10-20 turns, so 600 dialogues in total), and then measure the engag- ingness, consistency, and ﬂuency (all scored out of 5) as well as to try to detect the persona that the model is using, given the choice between that and a random persona. Consistency measures the coherence of the dialogue, e.g. “I have a dog” fol- lowed by “I have no pets” is not consistent. ", "page_idx": 2, "bbox": [307, 493.77020263671875, 526, 628.857666015625], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 31, "type": "text", "text": "The results are given in Table  4 . They show engagingness scores superior to Seq2Seq for all RetNRef variants, and with   $\\mathbf{Set}\\mathbf{NRef}^{++}$    slightly outperforming the retriever which it conditions on. Importantly however, it maintains this per- formance whilst still being able to generate text which a retrieval model cannot. It also performs well in the other metrics, although like the Mem- ory Network model, it is weaker at using the per- sona than Seq2Seq. Seq2Seq is inferior to the ", "page_idx": 2, "bbox": [307, 630.9432373046875, 526, 766.0316772460938], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 32, "type": "table", "page_idx": 3, "img_path": "layout_images/W18-5713_3.jpg", "table_caption": "Table 4: Human Evaluation scores for the models,scoring ﬂuency, engagingness, consistency and persona detec- tion, with standard deviation in parentheses. We consider engagingness to be the most important metric. ", "bbox": [70, 61, 526, 191], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "Method Engagingness Fluency Consistency Persona\nSeq2Seq (PPL) 2.70(1.17) 3.50(1.37) 3.90(1.37) —_-0.90(0.29)\nSeq2Seq (100 epochs) 2.76(1.15) 3.53(1.14) 3.84(1.38) —-0.85(0.35)\nMemory Network 3.66(1.26) 3.83(1.26)  3.61(1.36) —0.73(0.44)\nRetrieveNRefine 2.94(1.26) 3.65(1.28) — 3.72(1.32) —_-0.90(0.30)\nRetrieveNRefinet 3.50(1.33) 3.63(1.13) 3.55(1.33) 0.71045)\nRetrieveNRefinet* 3.80(1.18) 3.74(1.19) 3.80(1.40) —_-0.65(0.47)\n\n", "vlm_text": "The table compares different methods based on four metrics: Engagingness, Fluency, Consistency, and Persona. Each metric includes a mean value with a standard deviation in parentheses. Here is a summary of the data:\n\n1. **Seq2Seq (PPL):**\n   - Engagingness: 2.70 (1.17)\n   - Fluency: 3.50 (1.37)\n   - Consistency: 3.90 (1.37)\n   - Persona: 0.90 (0.29)\n\n2. **Seq2Seq (100 epochs):**\n   - Engagingness: 2.76 (1.15)\n   - Fluency: 3.53 (1.14)\n   - Consistency: 3.84 (1.38)\n   - Persona: 0.85 (0.35)\n\n3. **Memory Network:**\n   - Engagingness: 3.66 (1.26)\n   - Fluency: 3.83 (1.26)\n   - Consistency: 3.61 (1.36)\n   - Persona: 0.73 (0.44)\n\n4. **RetrieveNRefine:**\n   - Engagingness: 2.94 (1.26)\n   - Fluency: 3.65 (1.28)\n   - Consistency: 3.72 (1.32)\n   - Persona: 0.90 (0.30)\n\n5. **RetrieveNRefine+:**\n   - Engagingness: 3.50 (1.33)\n   - Fluency: 3.63 (1.13)\n   - Consistency: 3.55 (1.33)\n   - Persona: 0.71 (0.45)\n\n6. **RetrieveNRefine++:**\n   - Engagingness: 3.80 (1.18)\n   - Fluency: 3.74 (1.19)\n   - Consistency: 3.80 (1.40)\n   - Persona: 0.65 (0.47)\n\nThese results may illustrate the performance of each method across the different metrics, providing insights into the strengths and weaknesses of each approach."}
{"layout": 33, "type": "table", "page_idx": 3, "img_path": "layout_images/W18-5713_4.jpg", "table_caption": "Table 5: A/B testing by humans comparing model pairs, reporting win rates for A over B (excluding ties). ", "bbox": [83, 203, 510, 333], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "Comparison (A vs. B) Win Rate A Wins BWins Tie p-value\nRetrieveNRefine** vs. Memory Network | 54.5% 340 284 572 0.027\n\nRetrieveNRefine** vs. Seq2Seq 53.7% 571 492 203 0.016\nRetrieveNRefine** (retrieved) vs.Seq2Seq | 53.8% 290 249 87\nRetrieveNRefine** (generated) vs.Seq2Seq | 53.6% 281 243 116\nRetrieveNRefine* vs. Memory Network 51.63% 492 461 243\nRetrieveNRefine* vs. Human 30.13% 69 160 14\n\nSeq2Seq vs. Human 26.84% 62 169 22\n", "vlm_text": "The table presents the results of several comparative evaluations between different methods or models. Each row shows a comparison between two approaches labeled \"A vs. B,\" along with several statistics:\n\n1. **Comparison (A vs. B):** Specifies the two methods being compared in each evaluation.\n2. **Win Rate:** The proportion of instances where method A is preferred or wins over method B, expressed as a percentage.\n3. **A Wins:** The number of instances where method A is favored over method B.\n4. **B Wins:** The number of instances where method B is favored over method A.\n5. **Tie:** The number of instances where the comparison resulted in a tie.\n6. **p-value:** The p-value indicating the statistical significance of the observed win rate difference, where a lower value suggests a more statistically significant difference.\n\nIn summary, different versions of the \"RetrieveNRefine\" model are compared against alternatives like \"Memory Network,\" \"Seq2Seq,\" and human performance, with calculated win rates and statistical significance for each comparison."}
{"layout": 34, "type": "table", "page_idx": 3, "img_path": "layout_images/W18-5713_5.jpg", "table_footnote": "Table 6: Example dialogues (left) where RetNRef outperforms MemNet, and (right) where RetNRef outperforms Seq2Seq – by either paying attention to the retriever or not. The ﬁrst two rows are the previous two dialogue turns by Person 1 & 2, the following rows are the predictions for the next utterance of Person 1 by the various models. ", "bbox": [71, 346, 527, 520], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "Person |\n\nhey , george here . lets be friends\n\nyeah. well, i wish you luck there. we bought a cute 2 story house.\n\nPerson 2 hi george , i’m regina . do you enjoy dance ? nice , i don’t think i have ever left ohio.\nSeq2Seq ido not but i do have a lot of time to dance iam sorry. i am so scared of twins.\nMemNet hello george my name is pink iam from mississippi . just moved back here from austin texas\nRetNReft | ido. i enjoy dance. i am from tennessee. just moved here from austin texas.\nPerson | drinking coffee? what time is it there? thank you for that , you are what you believe ?\nPerson 2 830 pm haha my dad is a construction worker ||| look energy isn’t physical , only spiritual\nso he works really late nights\nSeq2Seq iam a big guy soi can help you i am not sure what that means\nMemNet yep . moonlight is amazing but northern do you do any sports ? swimming helps me keep my energy up.\nlight grab you too\nRetNReft | oh wow, that is a long time do you do any sports ? swimming helps me keep my energy up\n\n", "vlm_text": "The table appears to show a conversation simulation between two people and three different response systems titled \"Seq2Seq,\" \"MemNet,\" and \"RetNRef⁺.\" The table is divided into two sections based on different conversation contexts. \n\nIn the first section:\n- Two persons (Person 1 and Person 2) are engaging in a conversation about introducing themselves and discussing dancing.\n- \"Seq2Seq,\" \"MemNet,\" and \"RetNRef⁺\" provide potential responses to the conversation. These responses vary in their relevance and coherence to the conversation context.\n\nIn the second section:\n- Two persons are engaged in a conversation about time zones, work, and energy.\n- \"Seq2Seq,\" \"MemNet,\" and \"RetNRef⁺\" again provide responses with varying degrees of relevance and appropriateness to this context.\n\nThe purpose of the table seems to be to compare the effectiveness and appropriateness of the responses from the different systems in conversational scenarios."}
{"layout": 35, "type": "text", "text": "Memory Network Retriever in terms of engage- ment, in line with previous results. We also tried overtraining the Seq2Seq for 100 epochs instead of early stopping by validation on perplexity as it may overﬁt training sentences and act more as a retriever, but this did not help. ", "page_idx": 3, "bbox": [72, 540.094970703125, 290, 620.9863891601562], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 36, "type": "text", "text": "Some example dialogues of the RetNRef ++ model performing well (as scored by the evalua- tors) are shown in Tables  7  and  8 . Longer sen- tences from the bot (person 2) with more nu- anced entity information typically come from at- tending to the retriever, whereas the generator can also produce shorter replies independent of the re- triever that ﬁt the context well. There are still is- sues however, such as repeated phrases by the gen- erator, and some tendency to copy the speaking partner’s phrases that could be improved. ", "page_idx": 3, "bbox": [72, 630.9429321289062, 290, 766.0313720703125], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 37, "type": "text", "text": "", "page_idx": 3, "bbox": [307, 540.0949096679688, 486.916015625, 553.2403564453125], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 38, "type": "text", "text": "3.3 A/B Testing by Humans ", "text_level": 1, "page_idx": 3, "bbox": [306, 569, 444, 582], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 39, "type": "text", "text": "To compute a statistically more meaningful test, and to evaluate models more clearly against each other, we also tested models by pairing them against each other (different to the protocol pre- viously used for this dataset). We took human- human paired dialogues from the test set, up to a randomly chosen turn, and then computed the re- sponse of two rival models. The resulting dialogue history and the two choices are given to a third an- notator to evaluate and asked which model is best; they can also choose “unsure”. We collected over 1000 such examples, with each conversation being evaluated twice. The results are given in Table  5 . ", "page_idx": 3, "bbox": [307, 590.294921875, 525, 766.0313720703125], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 40, "type": "text", "text": "Persona 1 Persona 2 I am relatively tall. I like to play baseball. I like mexican food. I love eating seafood. I drive a subaru legacy. I enjoy learning new languages. My dog’s name is Drunky. I’m currently going for a marketing degree. I can touch my toes with my nose. I want to design ads in the future. ", "page_idx": 4, "bbox": [115, 61.17430114746094, 406.7847900390625, 122.11459350585938], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 41, "type": "text", "text": "[PERSON 1:] I’m driving to the mexican place tonight for dinner, but my Subaru is at the rental shop. [PERSON 2:] Yummy. I love mexican food, but I never eat vegetables [PERSON 1:] Oh, I do, I think that’s why i’m so tall! [PERSON 2:] how tall are you? I do not... I enjoy studying languages. [PERSON 1:] I’m 6 foot, a lot taller than my dog, Drunky. [PERSON 2:] I am sorry to hear that. I want to be 6 foot tall. [PERSON 1:] Do you have any talents? I can reach my toes using my nose. [PERSON 2:] Cool! I listen to audiobooks and speak one asian language. you like sushi? I do. [PERSON 1:] Oh sushi is my next favorite, after Mexican. What kind of car do you have? [PERSON 2:] I have a Nissan Sentra. I love it. ", "page_idx": 4, "bbox": [115, 131.23609924316406, 482, 231.70462036132812], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 42, "type": "text", "text": "Table 7: Example dialog between a human (Person 1) and the RetNRef ++   model (Person 2). References to never eating vegetables, listening to audiobooks and speaking one asian language and owning a Nissan Sentra appeared in the conditioned retrieved sentences, improving the overall engaging quality of the dialogue. ", "page_idx": 4, "bbox": [71, 238.24359130859375, 525, 277.77459716796875], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 43, "type": "table", "page_idx": 4, "img_path": "layout_images/W18-5713_6.jpg", "bbox": [115, 292, 399, 354], "page_size": [595.2760009765625, 841.8900146484375], "ocr_text": "Persona 1 Persona 2\n\nI am a lacto-ovo vegetarian. Thave brown hair.\n\nI like to hike. Tam Latina.\n\nI have red hair. My mother works for special needs clients.\nMy favorite drink is sprite. Tam a healer.\n\nI have a pet parrot named Tasha. | I love my family.\n", "vlm_text": "The table contains two columns, each labeled with \"Persona 1\" and \"Persona 2.\" It lists attributes or statements that describe each persona:\n\n**Persona 1:**\n- I am a lacto-ovo vegetarian.\n- I like to hike.\n- I have red hair.\n- My favorite drink is Sprite.\n- I have a pet parrot named Tasha.\n\n**Persona 2:**\n- I have brown hair.\n- I am Latina.\n- My mother works for special needs clients.\n- I am a healer.\n- I love my family."}
{"layout": 44, "type": "text", "text": "[PERSON 1:] I dont know about you but I love sprite. Its my favorite. [PERSON 2:] I like dr pepper a lot, but sprite is my second favorite. [PERSON 1:] Sprites great! I take it with me every day on my hikes. [PERSON 2:] I bet. I love to go to the water [PERSON 1:] Ya that sounds like a great time. I go with my pet parrot Tasha when I go [PERSON 2:] that is a good idea. I wish I had a parrot. [PERSON 1:] Ya its fun. As a pet owner you learn to love animals; im even a lactoovo vegetarian now [PERSON 2:] I love animals. I am vegan so I eat vegan food. [PERSON 1:] Sounds like me :D im vegan, im ginger, and i love sprite [PERSON 2:] I love animals. I am vegan so I eat a lot of it. ", "page_idx": 4, "bbox": [115, 362.4960632324219, 482, 462.9636535644531], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 45, "type": "text", "text": "Table 8: Example dialog between a human (Person 1) and the   $\\mathbf{Set}\\mathbf{NRef}^{++}$    model (Person 2). References to Dr. Pepper and wishing to have a parrot appeared in the conditioned retrieved sentences, improving the overall engaging quality of the dialogue. There are still issues however, such as repeated phrases by the generator, failure to use the persona adequately, and some tendency to copy the speaking partner’s phrases that could be improved. ", "page_idx": 4, "bbox": [71, 469.503662109375, 525, 520.9895629882812], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 46, "type": "text", "text": "RetrieveNReﬁne obtains statistically signiﬁcant wins over the retriever Memory Network model and the generator Seq2Seq model using a binomial two-tailed test, with win rate  ${\\sim}54\\%$  reaking down the wins between when RetNRef   exactly copies the retrieval utterance vs. generates we see that it chooses them about equally, with wins about equal in both cases. This shows it can effectively learn when to choose the retrieval utterance (when it is good), and when to ignore it and generate in- stead (when it is bad). Table  6 , which shows ex- ample outputs of our model, illustrates this. ", "page_idx": 4, "bbox": [72, 546.133056640625, 290, 708.3195190429688], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 47, "type": "text", "text": "RetNRef +   sometimes loses out when making small changes to the retrieved text, for example it made changes to “i once broke my nose try- ing to peak in on a jazz concert !” by replacing peak  with  glacier . Recall that   $\\mathbf{Set}\\mathbf{NRef}^{++}$    ﬁxes this problem by exactly copying the retrieved text when there is insigniﬁcant word overlap with the generated text; as such, it has a correspondingly larger win rate against Memory Networks   $(54.5\\%$  versus   $51.63\\%$  ). ", "page_idx": 4, "bbox": [72, 708.279052734375, 290, 766.031494140625], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 48, "type": "text", "text": "", "page_idx": 4, "bbox": [307, 542.1740112304688, 526, 627.0245361328125], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 49, "type": "text", "text": "We also computed a small sample of A/B tests directly against humans rather than models, and again see the win rate is higher for RetNRef. ", "page_idx": 4, "bbox": [307, 627.4280395507812, 526, 667.6715087890625], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 50, "type": "text", "text": "4 Conclusion ", "text_level": 1, "page_idx": 4, "bbox": [307, 678, 383, 690], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 51, "type": "text", "text": "In conclusion, we showed that retrieval models can be successfully used to improve generation models in dialogue, helping them avoid common issues such as producing short sentences with fre- quent words that ultimately are not engaging. Our RetNRef ++   model has similar statistics to human utterances and provides more engaging conversa- tions according to human judgments. ", "page_idx": 4, "bbox": [307, 698.6890258789062, 526, 766.031494140625], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 52, "type": "text", "text": "", "page_idx": 5, "bbox": [71, 59.72901153564453, 290, 103.93148803710938], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 53, "type": "text", "text": "Future work should investigate improved ways to incorporate retrieval in generation, both avoid- ing the heuristics we used here to improve per- formance, and seeing if more sophisticated ap- proaches than concatenation plus attention im- prove the results, for example by more clearly treating the inputs as independent sources, or training the models jointly. ", "page_idx": 5, "bbox": [71, 104.91400909423828, 290, 212.90353393554688], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 54, "type": "text", "text": "References ", "text_level": 1, "page_idx": 5, "bbox": [71, 239, 128, 250], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 55, "type": "text", "text": "Ziqiang Cao, Wenjie Li, Sujian Li, and Furu Wei. 2018. Retrieve, rerank and rewrite: Soft template based neural summarization. In  Proceedings of the 56th Annual Meeting of the Association for Compu- tational Linguistics (Volume 1: Long Papers) , vol- ume 1, pages 152–161. Angela Fan, David Grangier, and Michael Auli. 2017. Controllable abstractive summarization. arXiv preprint arXiv:1711.05217 . David Grangier and Michael Auli. 2017. Quickedit: Editing text & translations via simple delete actions. arXiv preprint arXiv:1711.04805 . Jiatao Gu, Yong Wang, Kyunghyun Cho, and Vic- tor OK Li. 2017. Search engine guided non- parametric neural machine translation. arXiv preprint arXiv:1705.07267 . Kelvin Guu, Tatsunori B Hashimoto, Yonatan Oren, and Percy Liang. 2017. Generating sen- tences by editing prototypes. arXiv preprint arXiv:1709.08878 . Zongcheng Ji, Zhengdong Lu, and Hang Li. 2014. An information retrieval approach to short text conver- sation.  arXiv preprint arXiv:1408.6988 . Marcin Junczys-Dowmunt and Roman Grundkiewicz. 2017. An exploration of neural sequence-to- sequence architectures for automatic post-editing. arXiv preprint arXiv:1706.04138 . Chia-Wei Liu, Ryan Lowe, Iulian V Serban, Michael Noseworthy, Laurent Charlin, and Joelle Pineau. 2016. How not to evaluate your dialogue system: An empirical study of unsupervised evaluation met- rics for dialogue response generation.  arXiv preprint arXiv:1603.08023 . Alexander Miller, Adam Fisch, Jesse Dodge, Amir- Hossein Karimi, Antoine Bordes, and Jason We- ston. 2016. Key-value memory networks for directly reading documents. arXiv preprint arXiv:1606.03126 . ", "page_idx": 5, "bbox": [71, 258.02166748046875, 290, 765.7654418945312], "page_size": [595.2760009765625, 841.8900146484375]}
{"layout": 56, "type": "text", "text": "Jan Niehues, Eunah Cho, Thanh-Le Ha, and Alex Waibel. 2016. Pre-translation for neural machine translation.  arXiv preprint arXiv:1610.05243 . Roman Novak, Michael Auli, and David Grangier. 2016. Iterative reﬁnement for machine translation. arXiv preprint arXiv:1610.06602 . Gaurav Pandey, Danish Contractor, Vineet Kumar, and Sachindra Joshi. 2018. Exemplar encoder-decoder for neural conversation generation. In  Proceed- ings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Pa- pers) , volume 1, pages 1329–1338. Allen Schmaltz, Yoon Kim, Alexander M Rush, and Stuart M Shieber. 2017. Adapting sequence models for sentence correction. arXiv preprint arXiv:1707.09067 . Iulian Vlad Serban, Ryan Lowe, Laurent Charlin, and Joelle Pineau. 2016. Generative deep neural net- works for dialogue: A short review.  arXiv preprint arXiv:1611.06216 . Ilya Sutskever, Oriol Vinyals, and Quoc V Le. 2014. Sequence to sequence learning with neural net- works. In  Advances in neural information process- ing systems , pages 3104–3112. Yingce Xia, Fei Tian, Lijun Wu, Jianxin Lin, Tao Qin, Nenghai Yu, and Tie-Yan Liu. 2017. Deliberation networks: Sequence generation beyond one-pass de- coding. In  Advances in Neural Information Process- ing Systems , pages 1782–1792. Saizheng Zhang, Emily Dinan, Jack Urbanek, Arthur Szlam, Douwe Kiela, and Jason Weston. 2018. Per- sonalizing dialogue agents: I have a dog, do you have pets too?  arXiv preprint arXiv:1801.07243 . ", "page_idx": 5, "bbox": [307, 64.5615234375, 525, 490.0159912109375], "page_size": [595.2760009765625, 841.8900146484375]}
